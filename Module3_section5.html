<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IAF 604 - Module 3A: Sampling Techniques for ML</title>
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    
    <!-- MathJax -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <style>
        :root {
            --bg0: #F8FAFC;
            --bg1: #F1F5F9;
            --panel: #FFFFFF;
            --text: #0F172A;
            --muted: rgba(15, 23, 42, 0.75);
            --border: rgba(148, 163, 184, 0.25);
            --primary: #2563EB;
            --secondary: #7C3AED;
            --accent: #DB2777;
            --success: #10B981;
            --warning: #F59E0B;
            --danger: #EF4444;
            --cyan: #06B6D4;
            --radius: 16px;
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg0);
            color: var(--text);
            line-height: 1.7;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 30px;
            border-radius: var(--radius);
            margin-bottom: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .header .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 12px 24px;
            background: white;
            color: var(--primary);
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            margin-top: 20px;
            transition: transform 0.2s;
        }
        
        .back-btn:hover {
            transform: translateY(-2px);
        }
        
        .content-grid {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 30px;
        }
        
        @media (max-width: 768px) {
            .content-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        .section {
            background: var(--panel);
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }
        
        .section h2 {
            color: var(--primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .definition {
            background: rgba(37, 99, 235, 0.08);
            border-left: 4px solid var(--primary);
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
        }
        
        .ml-connection {
            background: rgba(219, 39, 119, 0.08);
            border-left: 4px solid var(--accent);
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
        }
        
        .sampling-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .sampling-card {
            background: var(--bg1);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid var(--border);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .sampling-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }
        
        .sampling-card h4 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            color: var(--text);
        }
        
        .sampling-card ul {
            padding-left: 20px;
            margin: 15px 0;
        }
        
        .sampling-card li {
            margin-bottom: 8px;
        }
        
        .chart-container {
            margin: 25px 0;
            padding: 20px;
            border: 1px solid var(--border);
            border-radius: 12px;
            position: relative;
        }
        
        .chart-title {
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .chart-wrapper {
            height: 300px;
            position: relative;
        }
        
        .interactive-demo {
            background: var(--bg1);
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
            border: 2px dashed var(--border);
        }
        
        .demo-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .control-group {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid var(--border);
        }
        
        .control-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--text);
        }
        
        .control-group select,
        .control-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: white;
            color: var(--text);
            font-size: 14px;
        }
        
        .results-display {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .result-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid var(--border);
        }
        
        .result-value {
            font-size: 1.8rem;
            font-weight: 700;
            margin: 10px 0;
            color: var(--primary);
        }
        
        .result-label {
            font-size: 0.9rem;
            color: var(--muted);
        }
        
        .code-container {
            margin: 25px 0;
            border-radius: 12px;
            overflow: hidden;
        }
        
        .code-header {
            background: var(--primary);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }
        
        .code-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background: #1a1a1a;
        }
        
        .code-content.expanded {
            max-height: 2000px;
        }
        
        .code-content pre {
            margin: 0;
            padding: 20px;
            color: #e0e0e0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            background: var(--bg1);
            border-radius: 12px;
            overflow: hidden;
        }
        
        .comparison-table th {
            background: var(--primary);
            color: white;
            padding: 15px;
            text-align: left;
        }
        
        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border);
        }
        
        .comparison-table tr:last-child td {
            border-bottom: none;
        }
        
        .comparison-table tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.5);
        }
        
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .quick-nav {
            background: var(--panel);
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
        }
        
        .quick-nav h3 {
            margin-bottom: 15px;
            color: var(--primary);
        }
        
        .quick-nav a {
            display: block;
            padding: 12px 15px;
            margin: 5px 0;
            background: var(--bg1);
            border-radius: 8px;
            text-decoration: none;
            color: var(--text);
            transition: background 0.2s;
        }
        
        .quick-nav a:hover {
            background: rgba(37, 99, 235, 0.1);
        }
        
        .key-points {
            background: var(--panel);
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
        }
        
        .key-points h3 {
            margin-bottom: 15px;
            color: var(--primary);
        }
        
        .key-points ul {
            list-style: none;
        }
        
        .key-points li {
            padding: 10px 0;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .key-points li:last-child {
            border-bottom: none;
        }
        
        .case-study {
            background: rgba(16, 185, 129, 0.08);
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
            border-left: 4px solid var(--success);
        }
        
        .algorithm-flow {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 25px 0;
        }
        
        .flow-step {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 20px;
            background: var(--bg1);
            border-radius: 10px;
            border: 1px solid var(--border);
        }
        
        .step-number {
            background: var(--primary);
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            flex-shrink: 0;
        }
        
        .flow-arrow {
            text-align: center;
            color: var(--muted);
            margin: 5px 0;
        }
        
        footer {
            text-align: center;
            margin-top: 50px;
            padding: 30px;
            border-top: 1px solid var(--border);
            color: var(--muted);
        }
        
        .formula-box {
            background: rgba(245, 158, 11, 0.08);
            border: 1px solid var(--warning);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.1rem;
        }
        
        .sampling-visual {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .sample-item {
            background: white;
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            font-weight: 600;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .sample-item.selected {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            transform: scale(1.05);
        }
        
        .sample-item.highlighted {
            background: var(--warning);
            color: white;
            border-color: var(--warning);
        }
        
        .sample-item.stratified {
            background: var(--success);
            color: white;
            border-color: var(--success);
        }
        
        .sampling-progress {
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: var(--primary);
            border-radius: 4px;
            transition: width 0.3s;
        }
        
        .sample-stats {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            font-size: 0.9rem;
            color: var(--muted);
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 12px 24px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(37, 99, 235, 0.3);
        }
        
        .btn-secondary {
            background: var(--secondary);
        }
        
        .btn-success {
            background: var(--success);
        }
        
        .sample-action {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Sampling Techniques for Machine Learning</h1>
        <p class="subtitle">IAF 604 - Module 3A, Section 5: Master Data Sampling Methods for Better ML Models</p>
        <a href="Module3.html" class="back-btn">
            <i class="fa-solid fa-arrow-left"></i> Back to Main Module
        </a>
    </div>
    
    <div class="content-grid">
        <div class="main-content">
            <!-- Introduction -->
            <section class="section">
                <h2><i class="fa-solid fa-filter"></i> Why Sampling Matters in ML</h2>
                
                <div class="definition">
                    <p><strong>Sampling</strong> is the process of selecting a subset of data from a larger population. In machine learning, proper sampling is critical for:</p>
                    <ul style="padding-left: 20px; margin-top: 10px;">
                        <li>Training models efficiently (not all data needed)</li>
                        <li>Creating representative validation/test sets</li>
                        <li>Handling imbalanced datasets</li>
                        <li>Conducting A/B testing experiments</li>
                        <li>Reducing computational costs</li>
                    </ul>
                </div>
                
                <div class="ml-connection">
                    <h4><i class="fa-solid fa-brain"></i> ML Connection: The Sampling Challenge</h4>
                    <p>ML models are only as good as the data they're trained on. Poor sampling leads to:</p>
                    <ul style="padding-left: 20px; margin-top: 10px;">
                        <li><strong>Bias:</strong> Model learns patterns that don't generalize</li>
                        <li><strong>Overfitting:</strong> Model memorizes sample instead of learning patterns</li>
                        <li><strong>Underfitting:</strong> Sample doesn't capture population complexity</li>
                        <li><strong>Unfair Evaluation:</strong> Test set doesn't represent real-world data</li>
                    </ul>
                </div>
                
                <div class="sampling-grid">
                    <div class="sampling-card">
                        <h4><i class="fa-solid fa-dice"></i> Probability Sampling</h4>
                        <p>Every data point has a known chance of selection:</p>
                        <ul>
                            <li>Simple Random Sampling</li>
                            <li>Stratified Sampling</li>
                            <li>Systematic Sampling</li>
                            <li>Cluster Sampling</li>
                        </ul>
                        <p style="margin-top: 10px; color: var(--success); font-weight: 600;">
                            <i class="fa-solid fa-check"></i> Best for: A/B testing, general ML
                        </p>
                    </div>
                    
                    <div class="sampling-card">
                        <h4><i class="fa-solid fa-scale-balanced"></i> Balanced Sampling</h4>
                        <p>Addressing class imbalance:</p>
                        <ul>
                            <li>Oversampling (SMOTE)</li>
                            <li>Undersampling</li>
                            <li>Hybrid Methods</li>
                            <li>Cost-sensitive Learning</li>
                        </ul>
                        <p style="margin-top: 10px; color: var(--success); font-weight: 600;">
                            <i class="fa-solid fa-check"></i> Best for: Classification with imbalance
                        </p>
                    </div>
                    
                    <div class="sampling-card">
                        <h4><i class="fa-solid fa-arrow-trend-up"></i> Advanced Techniques</h4>
                        <p>Specialized ML applications:</p>
                        <ul>
                            <li>Bootstrapping</li>
                            <li>Cross-validation</li>
                            <li>Active Learning</li>
                            <li>Time-based Sampling</li>
                        </ul>
                        <p style="margin-top: 10px; color: var(--success); font-weight: 600;">
                            <i class="fa-solid fa-check"></i> Best for: Small datasets, time series
                        </p>
                    </div>
                </div>
            </section>
            
            <!-- The Sampling Problem -->
            <section class="section">
                <h2><i class="fa-solid fa-triangle-exclamation"></i> The Bias-Variance Tradeoff in Sampling</h2>
                
                <div class="formula-box">
                    \[
                    \text{Total Error} = \text{Bias}^2 + \text{Variance} + \text{Irreducible Error}
                    \]
                </div>
                
                <div class="chart-container">
                    <div class="chart-title">
                        <i class="fa-solid fa-chart-line"></i> How Sampling Affects Model Performance
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="biasVarianceChart"></canvas>
                    </div>
                </div>
                
                <div class="algorithm-flow">
                    <h3>The Sampling Decision Process</h3>
                    
                    <div class="flow-step">
                        <div class="step-number">1</div>
                        <div>
                            <strong>Assess Data Characteristics</strong>
                            <p>Check: Dataset size, class distribution, feature types, temporal patterns</p>
                        </div>
                    </div>
                    
                    <div class="flow-arrow">
                        <i class="fa-solid fa-arrow-down"></i>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">2</div>
                        <div>
                            <strong>Define Sampling Objectives</strong>
                            <p>What do you need? Training efficiency? Class balance? Temporal fairness?</p>
                        </div>
                    </div>
                    
                    <div class="flow-arrow">
                        <i class="fa-solid fa-arrow-down"></i>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">3</div>
                        <div>
                            <strong>Choose Sampling Method</strong>
                            <p>Select based on data characteristics and objectives</p>
                        </div>
                    </div>
                    
                    <div class="flow-arrow">
                        <i class="fa-solid fa-arrow-down"></i>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">4</div>
                        <div>
                            <strong>Validate Sampling Quality</strong>
                            <p>Check: Representativeness, bias minimization, preservation of patterns</p>
                        </div>
                    </div>
                </div>
                
                <div class="ml-connection">
                    <h4><i class="fa-solid fa-lightbulb"></i> Critical Insight</h4>
                    <p><strong>Never sample from your test set!</strong> Always split data BEFORE any sampling:</p>
                    <ol style="padding-left: 20px; margin-top: 10px;">
                        <li>Split: Train/Test (70/30 or 80/20)</li>
                        <li>Apply sampling ONLY to training data</li>
                        <li>Keep test set untouched and representative</li>
                        <li>This prevents data leakage and ensures fair evaluation</li>
                    </ol>
                </div>
            </section>
            
            <!-- Probability Sampling Methods -->
            <section class="section">
                <h2><i class="fa-solid fa-dice"></i> Probability Sampling Methods</h2>
                
                <h3>1. Simple Random Sampling</h3>
                <div class="formula-box">
                    Probability of selection: \( P(i) = \frac{1}{N} \) for all \( i \)
                </div>
                
                <div class="interactive-demo">
                    <h4><i class="fa-solid fa-sliders"></i> Interactive Demo: Simple Random Sampling</h4>
                    <p>Select a random sample from our population of 20 data points:</p>
                    
                    <div class="sampling-visual" id="randomSampleVisual">
                        <!-- Population items will be inserted here by JavaScript -->
                    </div>
                    
                    <div class="sample-action">
                        <button class="btn" onclick="performRandomSampling()">
                            <i class="fa-solid fa-shuffle"></i> Take Random Sample
                        </button>
                        <button class="btn btn-secondary" onclick="resetSampling()">
                            <i class="fa-solid fa-rotate"></i> Reset
                        </button>
                    </div>
                    
                    <div class="sampling-progress">
                        <div class="progress-bar" id="randomProgress" style="width: 0%"></div>
                    </div>
                    
                    <div class="sample-stats">
                        <div>Population: <span id="populationCount">20</span> items</div>
                        <div>Sample Size: <span id="sampleSize">5</span> items</div>
                        <div>Selected: <span id="selectedCount">0</span> items</div>
                    </div>
                    
                    <div class="results-display">
                        <div class="result-card">
                            <div class="result-label">Sample Mean</div>
                            <div class="result-value" id="sampleMean">0</div>
                        </div>
                        <div class="result-card">
                            <div class="result-label">Population Mean</div>
                            <div class="result-value" id="populationMean">75.5</div>
                        </div>
                        <div class="result-card">
                            <div class="result-label">Difference</div>
                            <div class="result-value" id="meanDifference">0</div>
                        </div>
                    </div>
                </div>
                
                <h3>2. Stratified Sampling</h3>
                <div class="formula-box">
                    Sample size per stratum: \( n_h = \frac{N_h}{N} \times n \)
                </div>
                
                <div class="ml-connection">
                    <h4><i class="fa-solid fa-chart-pie"></i> Why Stratify?</h4>
                    <p>When you have important subgroups (strata) in your data:</p>
                    <ul style="padding-left: 20px; margin-top: 10px;">
                        <li><strong>Customer segments:</strong> New vs returning vs VIP</li>
                        <li><strong>Geographic regions:</strong> North, South, East, West</li>
                        <li><strong>Product categories:</strong> Electronics, Clothing, Food</li>
                        <li><strong>Risk levels:</strong> Low, Medium, High risk</li>
                    </ul>
                    <p><strong>ML Application:</strong> Ensures all important subgroups are represented in training data.</p>
                </div>
                
                <div class="chart-container">
                    <div class="chart-title">
                        <i class="fa-solid fa-chart-bar"></i> Stratified vs Random Sampling Comparison
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="stratifiedChart"></canvas>
                    </div>
                </div>
                
                <h3>3. Systematic Sampling</h3>
                <div class="formula-box">
                    Selection interval: \( k = \frac{N}{n} \)
                </div>
                <p>Select every kth item from a randomly sorted list. Simple but can introduce bias if data has patterns.</p>
                
                <h3>4. Cluster Sampling</h3>
                <p>Randomly select clusters (groups), then include all items within selected clusters. Useful when:</p>
                <ul style="padding-left: 20px; margin-top: 10px;">
                    <li>Data naturally groups (schools, stores, cities)</li>
                    <li>Cost constraints (cheaper to sample groups than individuals)</li>
                    <li>Administrative convenience</li>
                </ul>
            </section>
            
            <!-- Balanced Sampling for Imbalanced Data -->
            <section class="section">
                <h2><i class="fa-solid fa-scale-balanced"></i> Handling Imbalanced Data</h2>
                
                <div class="definition">
                    <p><strong>Imbalanced Data:</strong> When one class significantly outnumbers others. Common in:</p>
                    <ul style="padding-left: 20px; margin-top: 10px;">
                        <li>Fraud detection (99.9% legitimate, 0.1% fraud)</li>
                        <li>Medical diagnosis (95% healthy, 5% disease)</li>
                        <li>Spam detection (90% normal, 10% spam)</li>
                        <li>Equipment failure prediction (99% working, 1% failing)</li>
                    </ul>
                </div>
                
                <div class="sampling-grid">
                    <div class="sampling-card">
                        <h4><i class="fa-solid fa-arrow-up"></i> Oversampling</h4>
                        <p><strong>Create more minority class samples:</strong></p>
                        <ul>
                            <li><strong>Random:</strong> Duplicate existing samples</li>
                            <li><strong>SMOTE:</strong> Create synthetic samples</li>
                            <li><strong>ADASYN:</strong> Adaptive synthetic sampling</li>
                        </ul>
                        <p style="margin-top: 10px; color: var(--warning);">
                            <i class="fa-solid fa-exclamation-triangle"></i> Risk: Overfitting to synthetic patterns
                        </p>
                    </div>
                    
                    <div class="sampling-card">
                        <h4><i class="fa-solid fa-arrow-down"></i> Undersampling</h4>
                        <p><strong>Reduce majority class samples:</strong></p>
                        <ul>
                            <li><strong>Random:</strong> Remove random samples</li>
                            <li><strong>Tomek Links:</strong> Remove ambiguous samples</li>
                            <li><strong>Cluster Centroids:</strong> Keep representative samples</li>
                        </ul>
                        <p style="margin-top: 10px; color: var(--warning);">
                            <i class="fa-solid fa-exclamation-triangle"></i> Risk: Losing important information
                        </p>
                    </div>
                    
                    <div class="sampling-card">
                        <h4><i class="fa-solid fa-gears"></i> Combined Methods</h4>
                        <p><strong>Best of both worlds:</strong></p>
                        <ul>
                            <li><strong>SMOTE + Tomek:</strong> Oversample minority, clean majority</li>
                            <li><strong>SMOTE + ENN:</strong> Synthetic generation + cleaning</li>
                            <li><strong>Cost-sensitive Learning:</strong> Weight classes differently</li>
                        </ul>
                        <p style="margin-top: 10px; color: var(--success);">
                            <i class="fa-solid fa-check"></i> Often gives best results
                        </p>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-title">
                        <i class="fa-solid fa-chart-pie"></i> Imbalanced Data Treatment Comparison
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="imbalanceChart"></canvas>
                    </div>
                </div>
                
                <div class="case-study">
                    <h4><i class="fa-solid fa-stethoscope"></i> Case Study: Medical Diagnosis</h4>
                    <p><strong>Problem:</strong> Predict rare disease (1% prevalence) with 95% accuracy</p>
                    <p><strong>Naive approach:</strong> Always predict "no disease" = 99% accuracy but useless!</p>
                    <p><strong>Sampling solution:</strong> Use SMOTE to balance classes, then train model</p>
                    <p><strong>Result:</strong> 85% accuracy overall, 80% recall for disease cases</p>
                </div>
            </section>
            
            <!-- Advanced Sampling Techniques -->
            <section class="section">
                <h2><i class="fa-solid fa-rocket"></i> Advanced Sampling Techniques</h2>
                
                <h3>1. Bootstrapping</h3>
                <div class="formula-box">
                    Sample with replacement: Each observation can be selected multiple times
                </div>
                
                <div class="ml-connection">
                    <h4><i class="fa-solid fa-chart-line"></i> Bootstrap Applications in ML</h4>
                    <ul style="padding-left: 20px; margin-top: 10px;">
                        <li><strong>Uncertainty Estimation:</strong> Confidence intervals for model predictions</li>
                        <li><strong>Bagging (Bootstrap Aggregating):</strong> Random Forest algorithm</li>
                        <li><strong>Model Validation:</strong> Estimate performance without separate test set</li>
                        <li><strong>Parameter Stability:</strong> Check if model parameters are stable across samples</li>
                    </ul>
                </div>
                
                <h3>2. Cross-Validation</h3>
                <div class="formula-box">
                    k-Fold CV: Partition data into k folds, train on k-1, test on 1, repeat k times
                </div>
                
                <div class="chart-container">
                    <div class="chart-title">
                        <i class="fa-solid fa-diagram-project"></i> Cross-Validation Strategies
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="crossValidationChart"></canvas>
                    </div>
                </div>
                
                <h3>3. Active Learning</h3>
                <p>ML-guided sampling: The model selects which data points would be most informative to label next.</p>
                
                <div class="algorithm-flow">
                    <div class="flow-step">
                        <div class="step-number">1</div>
                        <div>
                            <strong>Train initial model</strong>
                            <p>On small labeled dataset</p>
                        </div>
                    </div>
                    
                    <div class="flow-arrow">
                        <i class="fa-solid fa-arrow-right"></i>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">2</div>
                        <div>
                            <strong>Query unlabeled data</strong>
                            <p>Select most uncertain/valuable points</p>
                        </div>
                    </div>
                    
                    <div class="flow-arrow">
                        <i class="fa-solid fa-arrow-right"></i>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">3</div>
                        <div>
                            <strong>Get labels</strong>
                            <p>Human expert labels selected points</p>
                        </div>
                    </div>
                    
                    <div class="flow-arrow">
                        <i class="fa-solid fa-arrow-right"></i>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">4</div>
                        <div>
                            <strong>Retrain model</strong>
                            <p>Incorporate new labeled data</p>
                        </div>
                    </div>
                    
                    <div class="flow-arrow">
                        <i class="fa-solid fa-arrow-right"></i>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">5</div>
                        <div>
                            <strong>Repeat</strong>
                            <p>Until performance satisfactory or budget exhausted</p>
                        </div>
                    </div>
                </div>
                
                <h3>4. Time-based Sampling</h3>
                <p>For time series data, NEVER use random sampling! Instead:</p>
                <ul style="padding-left: 20px; margin-top: 10px;">
                    <li><strong>Train on past, test on future:</strong> Maintain temporal order</li>
                    <li><strong>Walk-forward validation:</strong> Simulate real-world deployment</li>
                    <li><strong>Seasonal sampling:</strong> Ensure all seasons represented</li>
                    <li><strong>Rolling windows:</strong> Fixed training window that moves through time</li>
                </ul>
            </section>
            
            <!-- Python Implementation -->
            <section class="section">
                <h2><i class="fa-brands fa-python"></i> Python Implementation</h2>
                
                <div class="code-container">
                    <div class="code-header" onclick="toggleCode('pythonCode')">
                        <span>Click to expand Python code for all sampling techniques</span>
                        <i class="fa-solid fa-chevron-down"></i>
                    </div>
                    <div class="code-content" id="pythonCode">
                        <pre><code># Comprehensive Sampling Techniques in Python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split, cross_val_score, StratifiedKFold, TimeSeriesSplit
from sklearn.utils import resample
from imblearn.over_sampling import SMOTE, RandomOverSampler
from imblearn.under_sampling import RandomUnderSampler, TomekLinks
from imblearn.combine import SMOTETomek
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import classification_report, confusion_matrix
import warnings
warnings.filterwarnings('ignore')

# ============================================================================
# 1) CREATE SIMULATED DATASETS
# ============================================================================
print("="*60)
print("SAMPLING TECHNIQUES DEMONSTRATION")
print("="*60)

np.random.seed(42)

# Dataset 1: Balanced dataset for basic sampling
n_samples = 1000
balanced_data = pd.DataFrame({
    'feature1': np.random.normal(0, 1, n_samples),
    'feature2': np.random.exponential(1, n_samples),
    'target': np.random.choice([0, 1], n_samples, p=[0.5, 0.5])
})

# Dataset 2: Imbalanced dataset (95% class 0, 5% class 1)
n_imbalanced = 1000
imbalanced_data = pd.DataFrame({
    'feature1': np.random.normal(0, 1, n_imbalanced),
    'feature2': np.random.exponential(1, n_imbalanced),
    'target': np.random.choice([0, 1], n_imbalanced, p=[0.95, 0.05])
})

# Dataset 3: Time series data
n_time = 500
dates = pd.date_range(start='2020-01-01', periods=n_time, freq='D')
time_series_data = pd.DataFrame({
    'date': dates,
    'value': np.cumsum(np.random.normal(0, 1, n_time)) + 100,
    'target': (np.cumsum(np.random.normal(0, 1, n_time)) > 0).astype(int)
})

print("\nDataset Information:")
print(f"1. Balanced dataset: {len(balanced_data)} samples, {balanced_data['target'].value_counts()[1]/len(balanced_data):.1%} positive")
print(f"2. Imbalanced dataset: {len(imbalanced_data)} samples, {imbalanced_data['target'].value_counts()[1]/len(imbalanced_data):.1%} positive")
print(f"3. Time series: {len(time_series_data)} samples from {dates[0].date()} to {dates[-1].date()}")

# ============================================================================
# 2) BASIC SAMPLING TECHNIQUES
# ============================================================================
print("\n" + "="*60)
print("BASIC SAMPLING TECHNIQUES")
print("="*60)

# Simple Random Sampling
print("\n1) Simple Random Sampling:")
sample_size = 200
random_sample = balanced_data.sample(n=sample_size, random_state=42)
print(f"   Random sample size: {len(random_sample)}")
print(f"   Sample proportion positive: {random_sample['target'].mean():.1%}")
print(f"   Population proportion positive: {balanced_data['target'].mean():.1%}")

# Stratified Sampling
print("\n2) Stratified Sampling:")
strat_train, strat_test = train_test_split(
    balanced_data,
    test_size=0.2,
    stratify=balanced_data['target'],
    random_state=42
)
print(f"   Training set size: {len(strat_train)}, positive: {strat_train['target'].mean():.1%}")
print(f"   Test set size: {len(strat_test)}, positive: {strat_test['target'].mean():.1%}")

# Systematic Sampling
print("\n3) Systematic Sampling:")
k = 5  # Select every 5th item
systematic_sample = balanced_data.iloc[::k]
print(f"   Systematic sample size: {len(systematic_sample)}")
print(f"   Sample proportion positive: {systematic_sample['target'].mean():.1%}")

# ============================================================================
# 3) HANDLING IMBALANCED DATA
# ============================================================================
print("\n" + "="*60)
print("HANDLING IMBALANCED DATA")
print("="*60)

# Original distribution
print("\nOriginal imbalanced distribution:")
original_counts = imbalanced_data['target'].value_counts()
print(f"   Class 0: {original_counts[0]} samples ({original_counts[0]/len(imbalanced_data):.1%})")
print(f"   Class 1: {original_counts[1]} samples ({original_counts[1]/len(imbalanced_data):.1%})")

# Random Oversampling
print("\n1) Random Oversampling:")
ros = RandomOverSampler(random_state=42)
X_resampled, y_resampled = ros.fit_resample(
    imbalanced_data[['feature1', 'feature2']],
    imbalanced_data['target']
)
print(f"   After oversampling: {len(X_resampled)} samples")
print(f"   Class distribution: {np.bincount(y_resampled)}")

# SMOTE (Synthetic Minority Oversampling)
print("\n2) SMOTE:")
smote = SMOTE(random_state=42)
X_smote, y_smote = smote.fit_resample(
    imbalanced_data[['feature1', 'feature2']],
    imbalanced_data['target']
)
print(f"   After SMOTE: {len(X_smote)} samples")
print(f"   Class distribution: {np.bincount(y_smote)}")

# Undersampling
print("\n3) Random Undersampling:")
rus = RandomUnderSampler(random_state=42)
X_under, y_under = rus.fit_resample(
    imbalanced_data[['feature1', 'feature2']],
    imbalanced_data['target']
)
print(f"   After undersampling: {len(X_under)} samples")
print(f"   Class distribution: {np.bincount(y_under)}")

# Combined SMOTE + Tomek
print("\n4) SMOTE + Tomek Links:")
smt = SMOTETomek(random_state=42)
X_smt, y_smt = smt.fit_resample(
    imbalanced_data[['feature1', 'feature2']],
    imbalanced_data['target']
)
print(f"   After SMOTE+Tomek: {len(X_smt)} samples")
print(f"   Class distribution: {np.bincount(y_smt)}")

# ============================================================================
# 4) ADVANCED TECHNIQUES
# ============================================================================
print("\n" + "="*60)
print("ADVANCED SAMPLING TECHNIQUES")
print("="*60)

# Bootstrapping
print("\n1) Bootstrapping:")
n_bootstraps = 1000
bootstrap_means = []

for i in range(n_bootstraps):
    bootstrap_sample = resample(balanced_data['feature1'], replace=True, n_samples=100)
    bootstrap_means.append(np.mean(bootstrap_sample))

mean_estimate = np.mean(bootstrap_means)
ci_lower = np.percentile(bootstrap_means, 2.5)
ci_upper = np.percentile(bootstrap_means, 97.5)

print(f"   Bootstrap mean estimate: {mean_estimate:.3f}")
print(f"   95% Confidence Interval: [{ci_lower:.3f}, {ci_upper:.3f}]")

# Cross-Validation
print("\n2) Cross-Validation:")
X = balanced_data[['feature1', 'feature2']]
y = balanced_data['target']

# k-Fold CV
cv_scores = cross_val_score(
    RandomForestClassifier(random_state=42),
    X, y,
    cv=5,
    scoring='accuracy'
)
print(f"   5-Fold CV accuracy scores: {cv_scores}")
print(f"   Mean CV accuracy: {np.mean(cv_scores):.3f} (+/- {np.std(cv_scores):.3f})")

# Stratified K-Fold
print("\n3) Stratified K-Fold (for imbalanced data):")
skf = StratifiedKFold(n_splits=5, shuffle=True, random_state=42)
stratified_scores = []

for train_idx, test_idx in skf.split(X, y):
    X_train, X_test = X.iloc[train_idx], X.iloc[test_idx]
    y_train, y_test = y.iloc[train_idx], y.iloc[test_idx]
    
    model = RandomForestClassifier(random_state=42)
    model.fit(X_train, y_train)
    score = model.score(X_test, y_test)
    stratified_scores.append(score)

print(f"   Stratified 5-Fold CV accuracy: {np.mean(stratified_scores):.3f}")

# Time Series Split
print("\n4) Time Series Split:")
tscv = TimeSeriesSplit(n_splits=5)
time_scores = []

for train_idx, test_idx in tscv.split(time_series_data):
    train_data = time_series_data.iloc[train_idx]
    test_data = time_series_data.iloc[test_idx]
    
    # Simple model for demonstration
    from sklearn.linear_model import LogisticRegression
    model = LogisticRegression()
    model.fit(train_data[['value']], train_data['target'])
    score = model.score(test_data[['value']], test_data['target'])
    time_scores.append(score)

print(f"   Time Series CV accuracy: {np.mean(time_scores):.3f}")

# ============================================================================
# 5) PRACTICAL ML EXAMPLE
# ============================================================================
print("\n" + "="*60)
print("PRACTICAL ML EXAMPLE: CREDIT FRAUD DETECTION")
print("="*60)

# Simulate credit card fraud dataset
np.random.seed(42)
n_transactions = 10000

fraud_data = pd.DataFrame({
    'amount': np.random.exponential(100, n_transactions),
    'time': np.random.uniform(0, 24, n_transactions),
    'location_distance': np.random.exponential(10, n_transactions),
    'is_fraud': np.random.choice([0, 1], n_transactions, p=[0.99, 0.01])
})

# Add patterns to fraud cases
fraud_mask = fraud_data['is_fraud'] == 1
fraud_data.loc[fraud_mask, 'amount'] *= 3  # Fraud transactions are larger
fraud_data.loc[fraud_mask, 'time'] = np.random.uniform(2, 6, fraud_mask.sum())  # Fraud happens at night

print("\nFraud Dataset Analysis:")
print(f"   Total transactions: {len(fraud_data)}")
print(f"   Fraudulent transactions: {fraud_data['is_fraud'].sum()} ({fraud_data['is_fraud'].mean():.2%})")
print(f"   Average amount (legit): ${fraud_data.loc[~fraud_mask, 'amount'].mean():.2f}")
print(f"   Average amount (fraud): ${fraud_data.loc[fraud_mask, 'amount'].mean():.2f}")

# Split data
X = fraud_data[['amount', 'time', 'location_distance']]
y = fraud_data['is_fraud']

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, stratify=y, random_state=42
)

print("\nBefore sampling:")
print(f"   Training fraud rate: {y_train.mean():.4%}")
print(f"   Test fraud rate: {y_test.mean():.4%}")

# Apply SMOTE to training data only
print("\nApplying SMOTE to training data...")
smote = SMOTE(random_state=42)
X_train_resampled, y_train_resampled = smote.fit_resample(X_train, y_train)

print(f"   After SMOTE - Training fraud rate: {y_train_resampled.mean():.2%}")

# Train and evaluate model
print("\nTraining Random Forest classifier...")
model = RandomForestClassifier(n_estimators=100, random_state=42, class_weight='balanced')
model.fit(X_train_resampled, y_train_resampled)

# Predictions
y_pred = model.predict(X_test)

print("\nModel Performance:")
print(classification_report(y_test, y_pred, target_names=['Legitimate', 'Fraud']))

# Confusion matrix
cm = confusion_matrix(y_test, y_pred)
print(f"Confusion Matrix:")
print(f"   True Negatives: {cm[0, 0]}")
print(f"   False Positives: {cm[0, 1]}")
print(f"   False Negatives: {cm[1, 0]}")
print(f"   True Positives: {cm[1, 1]}")

# Business metrics
fraud_caught = cm[1, 1] / cm[1].sum()
false_alarm_rate = cm[0, 1] / cm[0].sum()

print(f"\nBusiness Metrics:")
print(f"   Fraud Detection Rate: {fraud_caught:.1%}")
print(f"   False Alarm Rate: {false_alarm_rate:.1%}")

# ============================================================================
# 6) SAMPLING BEST PRACTICES
# ============================================================================
print("\n" + "="*60)
print("SAMPLING BEST PRACTICES FOR ML")
print("="*60)

print("\n1. Always split data before sampling:")
print("   • Train/Test split FIRST")
print("   • Apply sampling ONLY to training data")
print("   • Keep test set untouched and representative")

print("\n2. Choose sampling method based on:")
print("   • Dataset size and characteristics")
print("   • Class distribution")
print("   • Computational constraints")
print("   • Business requirements")

print("\n3. Validate sampling quality:")
print("   • Check distribution preservation")
print("   • Verify no data leakage")
print("   • Test model stability across samples")

print("\n4. Document everything:")
print("   • Sampling method used")
print("   • Parameters and random seed")
print("   • Sample sizes and distributions")
print("   • Justification for chosen method")

print("\nKey Takeaways:")
print("1. No one-size-fits-all sampling method")
print("2. Always consider the business context")
print("3. Sampling affects model fairness and bias")
print("4. Test multiple approaches")
print("5. Monitor model performance on new data")</code></pre>
                    </div>
                </div>
                
                <div class="ml-connection">
                    <h4><i class="fa-solid fa-code"></i> Key Python Libraries</h4>
                    <div class="sampling-grid">
                        <div class="sampling-card">
                            <h4><i class="fa-brands fa-python"></i> scikit-learn</h4>
                            <ul>
                                <li><code>train_test_split()</code></li>
                                <li><code>StratifiedKFold</code></li>
                                <li><code>cross_val_score()</code></li>
                                <li><code>resample()</code></li>
                            </ul>
                        </div>
                        
                        <div class="sampling-card">
                            <h4><i class="fa-solid fa-scale-balanced"></i> imbalanced-learn</h4>
                            <ul>
                                <li><code>SMOTE()</code></li>
                                <li><code>RandomOverSampler</code></li>
                                <li><code>TomekLinks()</code></li>
                                <li><code>SMOTETomek</code></li>
                            </ul>
                        </div>
                        
                        <div class="sampling-card">
                            <h4><i class="fa-solid fa-chart-line"></i> Custom Implementations</h4>
                            <ul>
                                <li>Active learning loops</li>
                                <li>Time series splits</li>
                                <li>Business-specific sampling</li>
                                <li>Performance monitoring</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Comparison & Selection Guide -->
            <section class="section">
                <h2><i class="fa-solid fa-list-check"></i> Sampling Method Selection Guide</h2>
                
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Method</th>
                            <th>Best For</th>
                            <th>Pros</th>
                            <th>Cons</th>
                            <th>ML Use Case</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Simple Random</strong></td>
                            <td>Large, balanced datasets</td>
                            <td>Simple, unbiased</td>
                            <td>May miss rare classes</td>
                            <td>Initial exploration, A/B testing</td>
                        </tr>
                        <tr>
                            <td><strong>Stratified</strong></td>
                            <td>Important subgroups</td>
                            <td>Preserves proportions</td>
                            <td>Need subgroup labels</td>
                            <td>Multi-class problems, A/B testing</td>
                        </tr>
                        <tr>
                            <td><strong>SMOTE</strong></td>
                            <td>Imbalanced classification</td>
                            <td>Creates synthetic data</td>
                            <td>May create unrealistic samples</td>
                            <td>Fraud detection, rare disease</td>
                        </tr>
                        <tr>
                            <td><strong>Undersampling</strong></td>
                            <td>Large imbalanced data</td>
                            <td>Reduces computation</td>
                            <td>Loses information</td>
                            <td>When minority class sufficient</td>
                        </tr>
                        <tr>
                            <td><strong>Bootstrapping</strong></td>
                            <td>Uncertainty estimation</td>
                            <td>Estimates variability</td>
                            <td>Computationally expensive</td>
                            <td>Confidence intervals, bagging</td>
                        </tr>
                        <tr>
                            <td><strong>Cross-Validation</strong></td>
                            <td>Small datasets</td>
                            <td>Maximizes data use</td>
                            <td>Computationally expensive</td>
                            <td>Hyperparameter tuning</td>
                        </tr>
                        <tr>
                            <td><strong>Active Learning</strong></td>
                            <td>Expensive labeling</td>
                            <td>Reduces labeling cost</td>
                            <td>Requires human in loop</td>
                            <td>Medical imaging, rare events</td>
                        </tr>
                        <tr>
                            <td><strong>Time Series Split</strong></td>
                            <td>Temporal data</td>
                            <td>Respects time order</td>
                            <td>Less data for early models</td>
                            <td>Stock prediction, sales forecasting</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="case-study">
                    <h4><i class="fa-solid fa-chart-line"></i> Case Study: E-commerce Recommendation System</h4>
                    <p><strong>Challenge:</strong> Train recommendation model on 10M user interactions</p>
                    <p><strong>Constraints:</strong> Compute budget limited, need results in 24 hours</p>
                    <p><strong>Sampling Solution:</strong></p>
                    <ol style="padding-left: 20px; margin-top: 10px;">
                        <li>Stratified sampling by user segment (new, active, VIP)</li>
                        <li>Oversample rare item interactions using SMOTE</li>
                        <li>Time-based split (train on 3 months, test on 1 month)</li>
                        <li>Bootstrapping for confidence intervals on recommendations</li>
                    </ol>
                    <p><strong>Result:</strong> Model trained in 4 hours, 15% better recommendations than random sampling</p>
                </div>
                
                <div class="ml-connection">
                    <h4><i class="fa-solid fa-flask-vial"></i> A/B Testing Connection</h4>
                    <p>Sampling is critical for valid A/B testing:</p>
                    <ul style="padding-left: 20px; margin-top: 10px;">
                        <li><strong>Random assignment:</strong> Ensures groups are comparable</li>
                        <li><strong>Stratification:</strong> Balances important covariates</li>
                        <li><strong>Sample size calculation:</strong> Determines test duration</li>
                        <li><strong>Sequential testing:</strong> Adaptive sampling based on results</li>
                    </ul>
                    <p><strong>Rule:</strong> If sampling is wrong, A/B test results are invalid!</p>
                </div>
            </section>
        </div>
        
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="quick-nav">
                <h3><i class="fa-solid fa-link"></i> Quick Navigation</h3>
                <a href="#intro"><i class="fa-solid fa-filter"></i> Why Sampling Matters</a>
                <a href="#bias-variance"><i class="fa-solid fa-triangle-exclamation"></i> Bias-Variance Tradeoff</a>
                <a href="#probability"><i class="fa-solid fa-dice"></i> Probability Sampling</a>
                <a href="#imbalanced"><i class="fa-solid fa-scale-balanced"></i> Imbalanced Data</a>
                <a href="#advanced"><i class="fa-solid fa-rocket"></i> Advanced Techniques</a>
                <a href="#python"><i class="fa-brands fa-python"></i> Python Code</a>
                <a href="#selection"><i class="fa-solid fa-list-check"></i> Selection Guide</a>
            </div>
            
            <div class="key-points">
                <h3><i class="fa-solid fa-key"></i> Key Principles</h3>
                <ul>
                    <li><i class="fa-solid fa-check" style="color: var(--success);"></i> Split before sampling</li>
                    <li><i class="fa-solid fa-check" style="color: var(--success);"></i> Know your data distribution</li>
                    <li><i class="fa-solid fa-check" style="color: var(--success);"></i> Match method to problem</li>
                    <li><i class="fa-solid fa-check" style="color: var(--success);"></i> Validate sampling quality</li>
                    <li><i class="fa-solid fa-check" style="color: var(--success);"></i> Document everything</li>
                    <li><i class="fa-solid fa-check" style="color: var(--success);"></i> Consider computational cost</li>
                    <li><i class="fa-solid fa-check" style="color: var(--success);"></i> Test multiple approaches</li>
                </ul>
            </div>
            
            <div class="key-points">
                <h3><i class="fa-solid fa-warning"></i> Common Mistakes</h3>
                <ul>
                    <li><i class="fa-solid fa-xmark" style="color: var(--danger);"></i> Sampling from test set</li>
                    <li><i class="fa-solid fa-xmark" style="color: var(--danger);"></i> Ignoring class imbalance</li>
                    <li><i class="fa-solid fa-xmark" style="color: var(--danger);"></i> Random sampling for time series</li>
                    <li><i class="fa-solid fa-xmark" style="color: var(--danger);"></i> Not stratifying important groups</li>
                    <li><i class="fa-solid fa-xmark" style="color: var(--danger);"></i> Overusing SMOTE</li>
                    <li><i class="fa-solid fa-xmark" style="color: var(--danger);"></i> Forgetting random seeds</li>
                    <li><i class="fa-solid fa-xmark" style="color: var(--danger);"></i> Not calculating sample size</li>
                </ul>
            </div>
            
            <div class="key-points">
                <h3><i class="fa-solid fa-clock"></i> Quick Reference</h3>
                <ul>
                    <li><strong>Balanced data:</strong> Stratified sampling</li>
                    <li><strong>Imbalanced data:</strong> SMOTE or hybrid</li>
                    <li><strong>Time series:</strong> Time-based split</li>
                    <li><strong>Small data:</strong> Cross-validation</li>
                    <li><strong>Uncertainty:</strong> Bootstrapping</li>
                    <li><strong>A/B testing:</strong> Random + stratification</li>
                    <li><strong>Active labeling:</strong> Active learning</li>
                </ul>
            </div>
        </div>
    </div>
    
    <footer>
        <p>IAF 604: Machine Learning & Predictive Analytics | Module 3A - Sampling Techniques</p>
        <p>© 2024 Department of Informatics and Analytics | Educational Material</p>
        <p style="margin-top: 10px;"><a href="Module3.html" style="color: var(--primary);">← Return to Main Module</a></p>
    </footer>
    
    <script>
        // Initialize MathJax
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
            }
        };
        
        // Toggle code blocks
        function toggleCode(id) {
            const content = document.getElementById(id);
            const icon = content.previousElementSibling.querySelector('i');
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                icon.classList.remove('fa-chevron-up');
                icon.classList.add('fa-chevron-down');
            } else {
                content.classList.add('expanded');
                icon.classList.remove('fa-chevron-down');
                icon.classList.add('fa-chevron-up');
            }
        }
        
        // Initialize charts
        let charts = {};
        
        function initCharts() {
            // Bias-Variance Tradeoff Chart
            const ctx1 = document.getElementById('biasVarianceChart').getContext('2d');
            charts.biasVarianceChart = new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: ['Small Sample', 'Balanced Sample', 'Large Sample', 'Stratified', 'Oversampled'],
                    datasets: [
                        {
                            label: 'Bias (Underfitting)',
                            data: [80, 40, 20, 15, 30],
                            borderColor: 'rgba(239, 68, 68, 1)',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Variance (Overfitting)',
                            data: [20, 30, 60, 40, 70],
                            borderColor: 'rgba(37, 99, 235, 1)',
                            backgroundColor: 'rgba(37, 99, 235, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Total Error',
                            data: [85, 50, 65, 45, 75],
                            borderColor: 'rgba(16, 185, 129, 1)',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'How Sampling Affects Bias and Variance'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${context.parsed.y}%`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: true,
                                text: 'Error Rate (%)'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Sampling Method'
                            }
                        }
                    }
                }
            });
            
            // Stratified vs Random Chart
            const ctx2 = document.getElementById('stratifiedChart').getContext('2d');
            charts.stratifiedChart = new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: ['Group A', 'Group B', 'Group C', 'Group D'],
                    datasets: [
                        {
                            label: 'Population Distribution',
                            data: [40, 30, 20, 10],
                            backgroundColor: 'rgba(148, 163, 184, 0.7)',
                            borderColor: 'rgba(148, 163, 184, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Random Sample',
                            data: [45, 25, 25, 5],
                            backgroundColor: 'rgba(239, 68, 68, 0.7)',
                            borderColor: 'rgba(239, 68, 68, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Stratified Sample',
                            data: [40, 30, 20, 10],
                            backgroundColor: 'rgba(16, 185, 129, 0.7)',
                            borderColor: 'rgba(16, 185, 129, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Stratified vs Random Sampling: Preserving Proportions'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 50,
                            title: {
                                display: true,
                                text: 'Percentage (%)'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Population Groups'
                            }
                        }
                    }
                }
            });
            
            // Imbalanced Data Chart
            const ctx3 = document.getElementById('imbalanceChart').getContext('2d');
            charts.imbalanceChart = new Chart(ctx3, {
                type: 'bar',
                data: {
                    labels: ['Original', 'Random Over', 'SMOTE', 'Random Under', 'SMOTE+Tomek'],
                    datasets: [
                        {
                            label: 'Majority Class',
                            data: [950, 950, 950, 50, 500],
                            backgroundColor: 'rgba(37, 99, 235, 0.7)',
                            borderColor: 'rgba(37, 99, 235, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Minority Class',
                            data: [50, 950, 950, 50, 500],
                            backgroundColor: 'rgba(239, 68, 68, 0.7)',
                            borderColor: 'rgba(239, 68, 68, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Imbalanced Data Treatment Methods'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of Samples'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Sampling Method'
                            }
                        }
                    }
                }
            });
            
            // Cross-Validation Chart
            const ctx4 = document.getElementById('crossValidationChart').getContext('2d');
            charts.crossValidationChart = new Chart(ctx4, {
                type: 'bar',
                data: {
                    labels: ['2-Fold', '5-Fold', '10-Fold', 'Leave-One-Out', 'Stratified 5-Fold', 'Time Series'],
                    datasets: [
                        {
                            label: 'Bias (Lower is Better)',
                            data: [25, 15, 10, 5, 8, 12],
                            backgroundColor: 'rgba(239, 68, 68, 0.7)',
                            borderColor: 'rgba(239, 68, 68, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Variance (Lower is Better)',
                            data: [15, 20, 25, 40, 18, 15],
                            backgroundColor: 'rgba(37, 99, 235, 0.7)',
                            borderColor: 'rgba(37, 99, 235, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Computational Cost',
                            data: [10, 25, 50, 100, 30, 20],
                            backgroundColor: 'rgba(245, 158, 11, 0.7)',
                            borderColor: 'rgba(245, 158, 11, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Cross-Validation Strategies Comparison'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Score (Arbitrary Units)'
                            }
                        },
                        x: {
                            ticks: {
                                maxRotation: 45,
                                minRotation: 45
                            }
                        }
                    }
                }
            });
            
            // Initialize random sampling visualization
            initRandomSamplingVisual();
        }
        
        // Random Sampling Interactive Demo
        let populationItems = [];
        let selectedItems = [];
        
        function initRandomSamplingVisual() {
            const container = document.getElementById('randomSampleVisual');
            container.innerHTML = '';
            
            // Create population with values
            populationItems = [];
            for (let i = 1; i <= 20; i++) {
                const value = Math.floor(Math.random() * 50) + 50; // Values between 50-100
                populationItems.push({
                    id: i,
                    value: value,
                    element: null
                });
            }
            
            // Calculate population mean
            const populationMean = populationItems.reduce((sum, item) => sum + item.value, 0) / populationItems.length;
            document.getElementById('populationMean').textContent = populationMean.toFixed(1);
            
            // Create visual items
            populationItems.forEach(item => {
                const div = document.createElement('div');
                div.className = 'sample-item';
                div.textContent = item.value;
                div.dataset.id = item.id;
                div.dataset.value = item.value;
                
                item.element = div;
                container.appendChild(div);
            });
        }
        
        function performRandomSampling() {
            const sampleSize = 5;
            const sampleItems = [];
            selectedItems = [];
            
            // Reset all items
            populationItems.forEach(item => {
                item.element.classList.remove('selected');
            });
            
            // Random selection without replacement
            const availableIndices = [...Array(populationItems.length).keys()];
            for (let i = 0; i < sampleSize; i++) {
                if (availableIndices.length === 0) break;
                
                const randomIndex = Math.floor(Math.random() * availableIndices.length);
                const itemIndex = availableIndices[randomIndex];
                const item = populationItems[itemIndex];
                
                sampleItems.push(item.value);
                selectedItems.push(item);
                item.element.classList.add('selected');
                
                // Remove selected index
                availableIndices.splice(randomIndex, 1);
            }
            
            // Update progress bar
            const progress = (sampleItems.length / sampleSize) * 100;
            document.getElementById('randomProgress').style.width = `${progress}%`;
            
            // Update counts
            document.getElementById('selectedCount').textContent = sampleItems.length;
            
            // Calculate statistics
            const sampleMean = sampleItems.reduce((sum, val) => sum + val, 0) / sampleItems.length;
            const populationMean = parseFloat(document.getElementById('populationMean').textContent);
            const difference = sampleMean - populationMean;
            
            document.getElementById('sampleMean').textContent = sampleMean.toFixed(1);
            document.getElementById('meanDifference').textContent = difference.toFixed(1);
            
            // Color code the difference
            const diffElement = document.getElementById('meanDifference');
            diffElement.style.color = Math.abs(difference) > 5 ? 
                (difference > 0 ? 'var(--success)' : 'var(--danger)') : 
                'var(--primary)';
        }
        
        function resetSampling() {
            selectedItems = [];
            populationItems.forEach(item => {
                item.element.classList.remove('selected');
            });
            
            document.getElementById('randomProgress').style.width = '0%';
            document.getElementById('selectedCount').textContent = '0';
            document.getElementById('sampleMean').textContent = '0';
            document.getElementById('meanDifference').textContent = '0';
            document.getElementById('meanDifference').style.color = 'var(--primary)';
        }
        
        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', () => {
            initCharts();
            initRandomSamplingVisual();
            
            // Typeset math
            if (MathJax.typeset) {
                MathJax.typeset();
            }
            
            // Add IDs for navigation
            const sections = document.querySelectorAll('.section');
            const sectionIds = [
                'intro', 'bias-variance', 'probability', 'imbalanced', 
                'advanced', 'python', 'selection'
            ];
            
            sections.forEach((section, index) => {
                if (index < sectionIds.length) {
                    section.id = sectionIds[index];
                }
            });
            
            // Update navigation links
            document.querySelectorAll('.quick-nav a').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        targetElement.scrollIntoView({ behavior: 'smooth' });
                    }
                });
            });
        });
        
        // Handle window resize
        window.addEventListener('resize', () => {
            Object.values(charts).forEach(chart => {
                if (chart) chart.resize();
            });
        });
    </script>
</body>
</html>
