<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Module 6: Supervised Machine Learning - Classification</title>

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- MathJax -->
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    /************************************************************
     * THEME: Aurora with Day/Night Mode (KEPT EXACTLY THE SAME)
     ************************************************************/
    :root {
      /* Night Mode (Default) */
      --bg0: #070A12;
      --bg1: #0B1020;
      --panel: #0F172A;
      --panel2: #0B1226;
      --card: #101B34;
      --text: #EAF0FF;
      --muted: rgba(234, 240, 255, 0.75);
      --muted2: rgba(234, 240, 255, 0.62);
      --border: rgba(148, 163, 184, 0.14);
      --shadow: 0 24px 60px rgba(0, 0, 0, 0.35);

      --primary: #60A5FA;
      --secondary: #A78BFA;
      --accent: #F472B6;
      --success: #34D399;
      --warning: #FBBF24;
      --danger: #FB7185;
      --cyan: #22D3EE;

      --radius: 16px;
      --radius2: 22px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;

      --ring: 0 0 0 4px rgba(96, 165, 250, 0.22);
      --ring2: 0 0 0 4px rgba(167, 139, 250, 0.20);

      /* Theme toggle variables */
      --mode-icon: '\f186'; /* moon */
      --mode-label: 'Night Mode';
    }

    /* Day Mode Theme */
    [data-theme="day"] {
      --bg0: #F8FAFC;
      --bg1: #F1F5F9;
      --panel: #FFFFFF;
      --panel2: #F8FAFC;
      --card: #FFFFFF;
      --text: #0F172A;
      --muted: rgba(15, 23, 42, 0.75);
      --muted2: rgba(15, 23, 42, 0.62);
      --border: rgba(148, 163, 184, 0.25);
      --shadow: 0 20px 40px rgba(0, 0, 0, 0.08);

      --primary: #2563EB;
      --secondary: #7C3AED;
      --accent: #DB2777;
      --success: #10B981;
      --warning: #F59E0B;
      --danger: #EF4444;
      --cyan: #06B6D4;

      --ring: 0 0 0 4px rgba(37, 99, 235, 0.15);
      --ring2: 0 0 0 4px rgba(124, 58, 237, 0.15);

      --mode-icon: '\f185'; /* sun */
      --mode-label: 'Day Mode';
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: smooth; }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: var(--bg0);
      color: var(--text);
      line-height: 1.7;
      min-height: 100vh;
      transition: background-color 0.35s ease, color 0.35s ease;
      overflow-x: hidden;
    }

    /* Dynamic background gradients */
    body:not([data-theme="day"]) {
      background:
        radial-gradient(1200px 520px at 15% 0%, rgba(96, 165, 250, 0.18), transparent 55%),
        radial-gradient(900px 520px at 90% 10%, rgba(244, 114, 182, 0.16), transparent 55%),
        radial-gradient(900px 520px at 75% 90%, rgba(34, 211, 238, 0.10), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
    }
    body[data-theme="day"] {
      background:
        radial-gradient(1200px 520px at 15% 0%, rgba(37, 99, 235, 0.08), transparent 55%),
        radial-gradient(900px 520px at 90% 10%, rgba(219, 39, 119, 0.08), transparent 55%),
        radial-gradient(900px 520px at 75% 90%, rgba(6, 182, 212, 0.06), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
    }

    .container { max-width: 1400px; margin: 0 auto; padding: 22px; }

    /************************************************************
     * THEME TOGGLE
     ************************************************************/
    .theme-toggle-container {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
    }
    .theme-toggle {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 12px 18px;
      border-radius: 50px;
      background: var(--panel);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      cursor: pointer;
      font-weight: 600;
      color: var(--text);
      backdrop-filter: blur(10px);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      border: none;
      font-family: inherit;
    }
    .theme-toggle:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15); }
    .theme-toggle::before {
      content: var(--mode-icon);
      font-family: 'Font Awesome 6 Free';
      font-weight: 900;
      font-size: 1.1em;
    }
    .theme-toggle .label { font-size: 0.9em; opacity: 0.9; white-space: nowrap; }

    /************************************************************
     * HEADER
     ************************************************************/
    header {
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.90), rgba(16, 27, 52, 0.92));
      border: 1px solid rgba(148, 163, 184, 0.18);
      color: var(--text);
      padding: 28px;
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      margin-bottom: 24px;
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(10px);
    }
    body[data-theme="day"] header {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.98));
      border: 1px solid rgba(148, 163, 184, 0.25);
    }
    .course-info h1 {
      font-size: clamp(24px, 2.8vw, 38px);
      margin-bottom: 8px;
      letter-spacing: -0.5px;
      line-height: 1.2;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .course-info h2 {
      font-size: clamp(16px, 1.8vw, 20px);
      font-weight: 400;
      opacity: 0.9;
      margin-bottom: 12px;
      color: var(--muted);
    }
    .badge {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 10px 18px;
      border-radius: 50px;
      font-weight: 700;
      letter-spacing: 0.2px;
      border: 1px solid var(--border);
      background: rgba(255, 255, 255, 0.08);
      width: fit-content;
      margin-top: 10px;
    }

    /************************************************************
     * NAVIGATION
     ************************************************************/
    .module-nav {
      display: flex;
      gap: 10px;
      margin: 20px 0;
      flex-wrap: wrap;
    }
    .nav-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 12px 20px;
      border-radius: 50px;
      background: var(--panel);
      border: 1px solid var(--border);
      color: var(--text);
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      text-decoration: none;
      border: none;
      font-family: inherit;
      font-size: 14px;
    }
    .nav-btn:hover { transform: translateY(-2px); border-color: var(--primary); box-shadow: var(--ring); }
    .nav-btn.active { background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; border: none; }

    /************************************************************
     * MAIN CONTENT
     ************************************************************/
    .module-content { display: none; }
    .module-content.active { display: block; animation: fadeIn 0.5s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .panel {
      background: var(--panel);
      border-radius: var(--radius);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      overflow: hidden;
      margin-bottom: 24px;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .panel:hover { box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1); transform: translateY(-2px); }
    .section { padding: 24px; }
    .section h3 {
      color: var(--text);
      margin-bottom: 20px;
      font-size: 1.4rem;
      display: flex;
      align-items: center;
      gap: 12px;
      padding-bottom: 12px;
      border-bottom: 1px solid var(--border);
    }
    .section h4 {
      color: var(--text);
      margin: 20px 0 12px;
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .section p { margin-bottom: 15px; color: var(--muted); }

    /************************************************************
     * EXPANDED CONTENT STYLES (SIMPLIFIED FOR STUDENTS)
     ************************************************************/
    .expanded-content {
      margin: 20px 0;
      padding: 20px;
      background: var(--panel2);
      border-radius: var(--radius);
      border: 1px solid var(--border);
    }

    .numeric-example {
      font-family: var(--mono);
      background: rgba(15, 23, 42, 0.15);
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
      border: 1px solid var(--border);
    }
    body[data-theme="day"] .numeric-example { background: rgba(15, 23, 42, 0.05); }
    .example-title {
      color: var(--accent);
      font-weight: 600;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .formula-with-calc {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin: 20px 0;
    }
    @media (max-width: 768px) { .formula-with-calc { grid-template-columns: 1fr; } }
    .formula-box {
      background: rgba(15, 23, 42, 0.1);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 20px;
      margin: 16px 0;
      font-family: var(--mono);
      text-align: center;
      position: relative;
    }
    body[data-theme="day"] .formula-box { background: rgba(15, 23, 42, 0.05); }
    .formula-label {
      position: absolute;
      top: -10px;
      left: 20px;
      background: var(--panel);
      padding: 0 10px;
      font-size: 12px;
      color: var(--muted);
      font-weight: 600;
    }

    /************************************************************
     * STUDENT-FRIENDLY EXPLANATION BOXES (SIMPLIFIED LANGUAGE)
     ************************************************************/
    .explanation-box {
      background: linear-gradient(135deg, rgba(96, 165, 250, 0.05), rgba(167, 139, 250, 0.05));
      border-left: 4px solid var(--primary);
      padding: 20px;
      margin: 20px 0;
      border-radius: 0 var(--radius) var(--radius) 0;
      position: relative;
    }
    .explanation-box::before {
      content: 'üìö In Simple Terms';
      position: absolute;
      top: -10px;
      left: 20px;
      background: var(--panel);
      padding: 0 10px;
      font-size: 12px;
      font-weight: 600;
      color: var(--primary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .explanation-box p:last-child { margin-bottom: 0; }

    .pro-tip {
      background: linear-gradient(135deg, rgba(52, 211, 153, 0.05), rgba(16, 185, 129, 0.05));
      border-left: 4px solid var(--success);
      padding: 20px;
      margin: 20px 0;
      border-radius: 0 var(--radius) var(--radius) 0;
      position: relative;
    }
    .pro-tip::before {
      content: 'üí° Study Tip';
      position: absolute;
      top: -10px;
      left: 20px;
      background: var(--panel);
      padding: 0 10px;
      font-size: 12px;
      font-weight: 600;
      color: var(--success);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .common-pitfall {
      background: linear-gradient(135deg, rgba(251, 113, 133, 0.05), rgba(239, 68, 68, 0.05));
      border-left: 4px solid var(--danger);
      padding: 20px;
      margin: 20px 0;
      border-radius: 0 var(--radius) var(--radius) 0;
      position: relative;
    }
    .common-pitfall::before {
      content: '‚ö†Ô∏è Watch Out!';
      position: absolute;
      top: -10px;
      left: 20px;
      background: var(--panel);
      padding: 0 10px;
      font-size: 12px;
      font-weight: 600;
      color: var(--danger);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /************************************************************
     * CLASSIFICATION VISUALIZATION
     ************************************************************/
    .classification-container {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 24px;
      margin: 20px 0;
    }
    @media (max-width: 1100px) { .classification-container { grid-template-columns: 1fr; } }
    .classification-chart {
      height: 400px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: var(--panel2);
      position: relative;
      overflow: hidden;
    }
    .classification-controls {
      padding: 20px;
      background: var(--panel2);
      border-radius: var(--radius);
      border: 1px solid var(--border);
    }
    .control-group { margin-bottom: 24px; }
    .control-group h4 {
      color: var(--text);
      margin-bottom: 16px;
      font-size: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .slider-container { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; }
    .slider-container label { min-width: 160px; color: var(--muted); font-size: 14px; }
    input[type="range"] { flex: 1; height: 6px; border-radius: 3px; background: var(--border); outline: none; accent-color: var(--primary); }
    .slider-value { min-width: 50px; text-align: right; font-family: var(--mono); font-weight: 600; color: var(--text); }

    /************************************************************
     * DECISION BOUNDARY PLOT
     ************************************************************/
    .boundary-container {
      width: 100%;
      height: 400px;
      position: relative;
      background: var(--panel2);
      border-radius: var(--radius);
      border: 1px solid var(--border);
      overflow: hidden;
      margin: 20px 0;
    }
    .boundary-canvas {
      width: 100%;
      height: 100%;
      display: block;
    }

    /************************************************************
     * CONFUSION MATRIX
     ************************************************************/
    .confusion-matrix {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 2px;
      background: var(--border);
      border: 2px solid var(--border);
      width: fit-content;
      margin: 20px auto;
    }
    .matrix-cell {
      padding: 20px 30px;
      text-align: center;
      background: var(--panel2);
      font-weight: 600;
    }
    .matrix-cell.label { background: var(--panel); color: var(--muted); }
    .matrix-cell.true-positive { background: rgba(52, 211, 153, 0.2); color: var(--success); }
    .matrix-cell.false-negative { background: rgba(251, 113, 133, 0.2); color: var(--danger); }
    .matrix-cell.false-positive { background: rgba(251, 113, 133, 0.2); color: var(--danger); }
    .matrix-cell.true-negative { background: rgba(52, 211, 153, 0.2); color: var(--success); }

    /************************************************************
     * ROC CURVE
     ************************************************************/
    .roc-container {
      height: 300px;
      margin: 20px 0;
    }

    /************************************************************
     * ALGORITHM COMPARISON
     ************************************************************/
    .algorithm-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin: 20px 0;
    }
    .algorithm-card {
      background: var(--panel2);
      border-radius: var(--radius);
      border: 1px solid var(--border);
      overflow: hidden;
      transition: transform 0.2s ease;
    }
    .algorithm-card:hover { transform: translateY(-4px); border-color: var(--primary); }
    .algorithm-header {
      padding: 16px;
      background: linear-gradient(135deg, rgba(96, 165, 250, 0.1), rgba(167, 139, 250, 0.1));
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .algorithm-icon {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
    }
    .algorithm-title { flex: 1; }
    .algorithm-title h4 { margin: 0; font-size: 16px; color: var(--text); }
    .algorithm-title p { margin: 2px 0 0; font-size: 12px; color: var(--muted); }
    .algorithm-body { padding: 16px; }
    .algorithm-metric {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-size: 13px;
      color: var(--muted);
    }
    .algorithm-metric span:last-child { font-weight: 600; color: var(--text); }

    /************************************************************
     * CODE EDITOR STYLES
     ************************************************************/
    .code-editor-container {
      margin: 20px 0;
      border-radius: var(--radius);
      overflow: hidden;
      border: 1px solid var(--border);
    }
    .code-header {
      background: var(--panel);
      padding: 12px 20px;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .code-title { font-weight: 600; color: var(--text); display: flex; align-items: center; gap: 8px; }
    .code-actions { display: flex; gap: 8px; }
    .code-body { background: var(--panel2); padding: 0; overflow: auto; }
    .code-block { font-family: var(--mono); font-size: 14px; line-height: 1.6; padding: 20px; margin: 0; tab-size: 2; white-space: pre-wrap; min-height: 200px; }
    .code-block code { display: block; color: var(--text); }
    .keyword { color: var(--danger); }
    .function { color: var(--primary); }
    .string { color: var(--success); }
    .comment { color: var(--muted2); font-style: italic; }
    .number { color: var(--warning); }
    .operator { color: var(--cyan); }

    /************************************************************
     * METRICS DISPLAY
     ************************************************************/
    .metrics-container {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 15px;
      margin: 20px 0;
    }
    @media (max-width: 1100px) { .metrics-container { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 600px) { .metrics-container { grid-template-columns: 1fr; } }
    .metric-card { padding: 20px; border-radius: var(--radius); border: 1px solid var(--border); background: var(--panel2); text-align: center; }
    .metric-value { font-size: 28px; font-weight: 700; margin: 10px 0; }
    .metric-label { font-size: 13px; color: var(--muted); text-transform: uppercase; letter-spacing: 0.5px; }
    .metric-good { color: var(--success); }
    .metric-warning { color: var(--warning); }
    .metric-danger { color: var(--danger); }

    /************************************************************
     * DETAILED TABLES
     ************************************************************/
    .detailed-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      overflow: hidden;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: var(--panel2);
      margin: 16px 0;
      font-size: 13px;
    }
    .detailed-table th, .detailed-table td {
      padding: 12px 16px;
      border-bottom: 1px solid var(--border);
      text-align: left;
    }
    .detailed-table th { background: var(--panel); color: var(--muted); font-weight: 600; }
    .detailed-table td { color: var(--text); font-family: var(--mono); }
    .detailed-table tr:last-child td { border-bottom: none; }
    .highlight-cell { background: rgba(96, 165, 250, 0.1); color: var(--primary); font-weight: 600; }

    /************************************************************
     * BUTTONS
     ************************************************************/
    .btn {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 12px 20px;
      border-radius: 12px;
      font-weight: 600;
      border: none;
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: inherit;
      font-size: 14px;
    }
    .btn-primary { background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; }
    .btn-secondary { background: var(--panel); color: var(--text); border: 1px solid var(--border); }
    .btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: var(--ring); }
    .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none !important; }
    .button-group { display: flex; gap: 10px; margin: 20px 0; flex-wrap: wrap; }

    /************************************************************
     * INFO BOXES
     ************************************************************/
    .info-box { padding: 20px; border-radius: 12px; border: 1px solid var(--border); margin: 20px 0; }
    .info-box.warning { border-left: 4px solid var(--warning); background: rgba(251, 191, 36, 0.08); }
    .info-box.success { border-left: 4px solid var(--success); background: rgba(52, 211, 153, 0.08); }
    .info-box.danger { border-left: 4px solid var(--danger); background: rgba(251, 113, 133, 0.08); }
    .info-box.info { border-left: 4px solid var(--primary); background: rgba(96, 165, 250, 0.08); }
    .info-box h4 { color: var(--text); margin-bottom: 10px; display: flex; align-items: center; gap: 10px; }

    /************************************************************
     * CONCEPT CARDS
     ************************************************************/
    .concept-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0; }
    .concept-card {
      padding: 20px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: var(--panel2);
      transition: transform 0.2s ease;
    }
    .concept-card:hover { transform: translateY(-4px); border-color: var(--primary); }
    .concept-card h5 { color: var(--text); margin-bottom: 12px; font-size: 16px; display: flex; align-items: center; gap: 10px; }
    .concept-card p { color: var(--muted); font-size: 14px; line-height: 1.6; }

    footer {
      text-align: center;
      margin-top: 32px;
      padding-top: 24px;
      border-top: 1px solid var(--border);
      color: var(--muted2);
      font-size: 14px;
      line-height: 1.6;
    }

    .highlight { background: rgba(96, 165, 250, 0.1); padding: 2px 6px; border-radius: 4px; color: var(--primary); font-weight: 600; }
    .mono { font-family: var(--mono); background: rgba(15, 23, 42, 0.1); padding: 2px 6px; border-radius: 4px; color: var(--text); }
    .math-equation { font-family: "Times New Roman", serif; font-style: italic; font-size: 1.1em; }

    .library-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      margin: 2px;
    }
    .sklearn-badge { background: rgba(231, 76, 60, 0.1); color: #E74C3C; border: 1px solid rgba(231, 76, 60, 0.3); }
  </style>
</head>

<body data-theme="night">
  <!-- Theme Toggle -->
  <div class="theme-toggle-container">
    <button class="theme-toggle" id="themeToggle" type="button" aria-label="Theme: Night Mode (click to toggle)">
      <span class="label" id="themeLabel">Night Mode</span>
    </button>
  </div>

  <div class="container">
    <header>
      <div class="course-info">
        <h1>üè∑Ô∏è Module 6: Supervised Machine Learning - Classification</h1>
        <h2>Supervised Machine Learning</h2>
        <div class="badge"><i class="fas fa-tags"></i> IAF 604: Learn to predict categories - spam, fraud, diseases, and more!</div>
        <p style="margin-top: 15px; color: var(--muted);">
          <strong>üéØ Your Learning Goals:</strong> By the end of this module, you'll understand how classification algorithms work,
          how to evaluate them properly (not just accuracy!), and when to use each one.
        </p>
      </div>
    </header>

    <!-- Navigation -->
    <div class="module-nav">
      <button class="nav-btn active" data-module="intro"><i class="fas fa-graduation-cap"></i> 1. What is Classification?</button>
      <button class="nav-btn" data-module="logistic"><i class="fas fa-sigmoid"></i> 2. Logistic Regression</button>
      <button class="nav-btn" data-module="knn"><i class="fas fa-users"></i> 3. K-Nearest Neighbors</button>
      <button class="nav-btn" data-module="naive-bayes"><i class="fas fa-chart-pie"></i> 4. Naive Bayes</button>
      <button class="nav-btn" data-module="svm"><i class="fas fa-vector-square"></i> 5. SVM</button>
      <button class="nav-btn" data-module="tree-classification"><i class="fas fa-tree"></i> 6. Decision Trees</button>
      <button class="nav-btn" data-module="ensemble-class"><i class="fas fa-layer-group"></i> 7. Random Forest & XGBoost</button>
      <button class="nav-btn" data-module="evaluation-class"><i class="fas fa-clipboard-check"></i> 8. Metrics (Beyond Accuracy)</button>
      <button class="nav-btn" data-module="hands-on-class"><i class="fas fa-laptop-code"></i> 9. Try It Yourself!</button>
      <button class="nav-btn" data-module="resources-class"><i class="fas fa-book"></i> 10. Practice Resources</button>
    </div>

    <!-- ================================================
         SECTION 1: INTRODUCTION
    ================================================= -->
    <div id="intro" class="module-content active">

      <div class="panel section">
        <h3><i class="fas fa-graduation-cap"></i> 1.1 Classification: Predicting Categories</h3>

        <div class="info-box info">
          <h4><i class="fas fa-brain"></i> The Basic Idea</h4>
          <p>
            Imagine you're teaching a friend to identify spam emails. You'd show them examples:
            <span class="highlight">"This email says 'YOU WON $1,000,000' - it's spam"</span> and
            <span class="highlight">"This email from your professor - not spam"</span>.
          </p>
          <p>
            <strong>That's classification!</strong> The computer learns from labeled examples to put new items into categories.
          </p>
        </div>

        <div class="explanation-box">
          <p><strong>üìö In Simple Terms:</strong> Classification is like sorting laundry - you put each item into a pile (whites, colors, delicates). The computer learns the rules for sorting from examples you've already labeled.</p>
          <p><strong>Real-Life Examples:</strong>
            <ul style="padding-left:20px;">
              <li>üìß Spam detection: Spam or Not Spam</li>
              <li>üè• Medical diagnosis: Disease or Healthy</li>
              <li>üí≥ Fraud detection: Fraudulent or Legitimate</li>
              <li>üì∏ Image recognition: Cat, Dog, or Bird</li>
              <li>‚≠ê Sentiment analysis: Positive or Negative review</li>
            </ul>
          </p>
        </div>

        <div class="expanded-content">
          <h4><i class="fas fa-sitemap"></i> Two Types of Classification</h4>

          <div class="concept-grid">
            <div class="concept-card">
              <h5><i class="fas fa-divide"></i> Binary Classification</h5>
              <p><strong>Two possible outcomes</strong></p>
              <p><strong>Examples:</strong>
                <ul style="padding-left:20px;">
                  <li>‚úÖ Spam / Not Spam</li>
                  <li>‚úÖ Fraud / Not Fraud</li>
                  <li>‚úÖ Sick / Healthy</li>
                  <li>‚úÖ Churn / Stay</li>
                </ul>
              </p>
              <p>This is where most courses start - simpler to understand and evaluate.</p>
            </div>

            <div class="concept-card">
              <h5><i class="fas fa-cubes"></i> Multi-class Classification</h5>
              <p><strong>Three or more possible outcomes</strong></p>
              <p><strong>Examples:</strong>
                <ul style="padding-left:20px;">
                  <li>üì∏ Image: Cat vs Dog vs Bird</li>
                  <li>‚≠ê Ratings: 1, 2, 3, 4, or 5 stars</li>
                  <li>üî§ Handwriting: Letters A-Z</li>
                  <li>üß¨ Cancer type: 10 different subtypes</li>
                </ul>
              </p>
            </div>
          </div>

          <div class="pro-tip">
            <p><strong>üí° Easy Rule:</strong> If your answer is a category (like "spam" or "not spam") ‚Üí use classification. If it's a number (like price, temperature) ‚Üí that's regression from Module 5. But sometimes we use classification to predict probabilities (like 75% chance of spam) and then set a threshold!</p>
          </div>
        </div>

        <h4><i class="fas fa-table"></i> Let's Look at Real Data</h4>
        <p>
          Here's a tiny dataset of emails. Features describe the email, target is the category.
        </p>

        <table class="detailed-table">
          <thead>
            <tr>
              <th>üìß Contains "win"</th><th>üí∞ Contains "money"</th><th>üîó Has link</th><th>üìè Length</th><th>üè∑Ô∏è Spam? (Target)</th>
            </tr>
          </thead>
          <tbody>
            <tr><td>Yes</td><td>Yes</td><td>Yes</td><td>50</td><td class="highlight-cell">Spam</td></tr>
            <tr><td>No</td><td>No</td><td>No</td><td>1200</td><td class="highlight-cell">Not Spam</td></tr>
            <tr><td>Yes</td><td>No</td><td>Yes</td><td>80</td><td class="highlight-cell">Spam</td></tr>
            <tr><td>No</td><td>No</td><td>Yes</td><td>600</td><td class="highlight-cell">Not Spam</td></tr>
          </tbody>
        </table>

        <div class="explanation-box">
          <p><strong>üîç What patterns do you see?</strong> Short emails with "win" and links tend to be spam. Long emails from known contacts are usually not spam. The computer learns these patterns automatically!</p>
        </div>
      </div>

      <div class="panel section">
        <h3><i class="fas fa-question-circle"></i> 1.2 Classification vs Regression</h3>

        <div class="formula-with-calc">
          <div class="formula-box">
            <div class="formula-label">Regression</div>
            <div style="text-align:left; padding: 15px;">
              <strong>Predicts NUMBERS</strong><br/><br/>
              ‚Ä¢ House price: $425,000<br/>
              ‚Ä¢ Temperature: 72.5¬∞F<br/>
              ‚Ä¢ Sales: 1,250 units<br/>
              <span class="math-equation">y = 2.5x + 10</span>
            </div>
          </div>

          <div class="formula-box">
            <div class="formula-label">Classification</div>
            <div style="text-align:left; padding: 15px;">
              <strong>Predicts CATEGORIES</strong><br/><br/>
              ‚Ä¢ Spam? Yes or No<br/>
              ‚Ä¢ Digit: 0,1,2,...,9<br/>
              ‚Ä¢ Disease: Type A, B, or C<br/>
              <span class="math-equation">P(y=k | X) ‚àà [0,1]</span>
            </div>
          </div>
        </div>

        <div class="common-pitfall">
          <p><strong>‚ö†Ô∏è Don't use regression for classification!</strong> If you code "spam" as 1 and "not spam" as 0 and use linear regression, you might get predictions like 0.7 (okay) but also -0.3 or 1.4 (nonsense!). Classification algorithms are designed to output valid probabilities between 0 and 1.</p>
        </div>
      </div>
    </div>

    <!-- ================================================
         SECTION 2: LOGISTIC REGRESSION
    ================================================= -->
    <div id="logistic" class="module-content">

      <div class="panel section">
        <h3><i class="fas fa-sigmoid"></i> 2.1 Logistic Regression: The S-Curve for Probabilities</h3>

        <div class="info-box info">
          <h4><i class="fas fa-lightbulb"></i> The Core Idea</h4>
          <p>
            <strong>Logistic regression</strong> takes the linear regression line and squishes it through an "S-shaped" function called the sigmoid.
            The result is always between 0 and 1 - perfect for probabilities!
          </p>
          <p class="math-equation" style="font-size: 1.2rem; text-align: center; margin: 20px 0;">
            P(y=1) = 1 / (1 + e<sup>-(b + m‚ÇÅx‚ÇÅ + m‚ÇÇx‚ÇÇ + ...)</sup>)
          </p>
          <p>
            When the linear part is very negative ‚Üí probability near 0.<br/>
            When the linear part is very positive ‚Üí probability near 1.<br/>
            At the decision boundary (linear part = 0) ‚Üí probability = 0.5.
          </p>
        </div>

        <div class="explanation-box">
          <p><strong>üìö In Simple Terms:</strong> Imagine a straight line is too rigid - it can go below 0 or above 1. Logistic regression bends that line into an S-shape that's forced between 0 and 1. It's like putting a rubber band around the line to keep it in bounds!</p>
          <p><strong>Real-Life Example:</strong> Banks use logistic regression to predict probability of default. A customer with perfect credit gets probability near 0 (won't default), someone with terrible credit gets probability near 1 (will default). The S-curve captures that there are diminishing returns - after a point, more debt doesn't increase probability as much.</p>
        </div>

        <div class="regression-container">
          <div class="classification-chart"><canvas id="logisticChart"></canvas></div>

          <div class="classification-controls">
            <div class="control-group">
              <h4><i class="fas fa-sliders-h"></i> Play with the Demo</h4>
              <div class="slider-container">
                <label><i class="fas fa-arrow-left"></i> Slope (m):</label>
                <input type="range" id="logisticSlope" min="0.1" max="5" step="0.1" value="1">
                <span class="slider-value" id="logisticSlopeValue">1.0</span>
              </div>
              <div class="slider-container">
                <label><i class="fas fa-arrows-alt-v"></i> Intercept (b):</label>
                <input type="range" id="logisticIntercept" min="-5" max="5" step="0.5" value="0">
                <span class="slider-value" id="logisticInterceptValue">0.0</span>
              </div>
              <div class="slider-container">
                <label><i class="fas fa-bullseye"></i> Decision Threshold:</label>
                <input type="range" id="logisticThreshold" min="0.1" max="0.9" step="0.05" value="0.5">
                <span class="slider-value" id="logisticThresholdValue">0.5</span>
              </div>
            </div>

            <div class="button-group">
              <button class="btn btn-primary" onclick="updateLogistic()">
                <i class="fas fa-play"></i> Update
              </button>
              <button class="btn btn-secondary" onclick="generateLogisticData()">
                <i class="fas fa-sync"></i> New Data
              </button>
            </div>

            <div class="metrics-container" style="margin-top: 20px;">
              <div class="metric-card">
                <div class="metric-label">Accuracy</div>
                <div class="metric-value" id="logisticAcc">0.85</div>
              </div>
              <div class="metric-card">
                <div class="metric-label">Precision</div>
                <div class="metric-value" id="logisticPrec">0.82</div>
              </div>
              <div class="metric-card">
                <div class="metric-label">Recall</div>
                <div class="metric-value" id="logisticRec">0.79</div>
              </div>
              <div class="metric-card">
                <div class="metric-label">F1 Score</div>
                <div class="metric-value" id="logisticF1">0.80</div>
              </div>
            </div>

            <div class="explanation-box" style="margin-top: 20px;">
              <p><strong>üëÜ Try this:</strong></p>
              <ul style="padding-left:20px;">
                <li><strong>Increase slope:</strong> Steeper S-curve, more certain predictions</li>
                <li><strong>Change intercept:</strong> Shifts curve left/right, changes balance</li>
                <li><strong>Adjust threshold:</strong> Lower threshold = more "spam" predictions (higher recall, lower precision)</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="code-editor-container">
          <div class="code-header">
            <div class="code-title"><i class="fab fa-python"></i> Logistic Regression in Python</div>
          </div>
          <div class="code-body">
            <pre class="code-block"><code><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression
<span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split
<span class="keyword">import</span> pandas <span class="keyword">as</span> pd

<span class="comment"># Sample email data</span>
data = pd.DataFrame({
    'contains_win': [1, 0, 1, 0, 1, 0],
    'contains_money': [1, 0, 0, 0, 1, 0],
    'has_link': [1, 0, 1, 1, 1, 0],
    'length': [50, 1200, 80, 600, 40, 900],
    'is_spam': [1, 0, 1, 0, 1, 0]  <span class="comment"># 1 = spam, 0 = not spam</span>
})

X = data[['contains_win', 'contains_money', 'has_link', 'length']]
y = data['is_spam']

<span class="comment"># Split data</span>
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)

<span class="comment"># Create and train model</span>
model = LogisticRegression()
model.<span class="function">fit</span>(X_train, y_train)

<span class="comment"># Get predictions and probabilities</span>
y_pred = model.<span class="function">predict</span>(X_test)  <span class="comment"># 0 or 1</span>
y_proba = model.<span class="function">predict_proba</span>(X_test)  <span class="comment"># Probabilities for both classes</span>

<span class="keyword">print</span>(<span class="string">f"Coefficients: {model.coef_[0]}"</span>)  <span class="comment"># How much each feature matters</span>
<span class="keyword">print</span>(<span class="string">f"Intercept: {model.intercept_[0]}"</span>)

<span class="comment"># For a new email</span>
new_email = pd.DataFrame([[1, 1, 1, 60]], columns=X.columns)
spam_probability = model.<span class="function">predict_proba</span>(new_email)[0][1]  <span class="comment"># P(spam)</span>
<span class="keyword">print</span>(<span class="string">f"Spam probability: {spam_probability:.2f}"</span>)</code></pre>
          </div>
        </div>

        <div class="pro-tip">
          <p><strong>üí° Important:</strong> Despite the name, logistic regression is a CLASSIFICATION algorithm, not regression! The name is historical because it's based on linear regression + logistic function.</p>
        </div>
      </div>
    </div>

    <!-- ================================================
         SECTION 3: K-NEAREST NEIGHBORS (KNN)
    ================================================= -->
    <div id="knn" class="module-content">

      <div class="panel section">
        <h3><i class="fas fa-users"></i> 3.1 K-Nearest Neighbors: Birds of a Feather Flock Together</h3>

        <div class="info-box info">
          <h4><i class="fas fa-lightbulb"></i> The Core Idea</h4>
          <p>
            <strong>KNN</strong> is the simplest classification algorithm: Find the K most similar examples in your training data
            and take a vote! If 7 out of 10 similar houses are not spam, your new email is probably not spam.
          </p>
          <p>
            No training step - it just memorizes all the data and compares new points to old ones at prediction time.
          </p>
        </div>

        <div class="explanation-box">
          <p><strong>üìö In Simple Terms:</strong> KNN is like asking your 5 closest friends for advice and going with the majority opinion. The "closeness" is measured by distance in feature space (like how similar emails are based on words they contain).</p>
          <p><strong>Real-Life Example:</strong> Recommendation systems use KNN: "Users who liked this movie also liked..." Find the K most similar users and recommend what they liked.</p>
        </div>

        <div class="regression-container">
          <div class="classification-chart"><canvas id="knnChart"></canvas></div>

          <div class="classification-controls">
            <div class="control-group">
              <h4><i class="fas fa-sliders-h"></i> KNN Controls</h4>
              <div class="slider-container">
                <label><i class="fas fa-users"></i> K (Neighbors):</label>
                <input type="range" id="kValue" min="1" max="20" step="1" value="5">
                <span class="slider-value" id="kValueValue">5</span>
              </div>
              <p style="font-size:12px;">K=1: Very flexible, overfits | K=20: Smooth, may underfit</p>
              
              <div class="slider-container">
                <label><i class="fas fa-arrows-alt"></i> Distance Metric:</label>
                <select id="distanceMetric" class="btn btn-secondary" style="padding: 8px;">
                  <option value="euclidean">Euclidean (straight line)</option>
                  <option value="manhattan">Manhattan (city block)</option>
                </select>
              </div>
            </div>

            <div class="button-group">
              <button class="btn btn-primary" onclick="updateKNN()"><i class="fas fa-play"></i> Update</button>
              <button class="btn btn-secondary" onclick="generateKNNData()"><i class="fas fa-sync"></i> New Data</button>
            </div>

            <div class="metrics-container" style="margin-top: 20px;">
              <div class="metric-card">
                <div class="metric-label">Accuracy</div>
                <div class="metric-value" id="knnAcc">0.92</div>
              </div>
              <div class="metric-card">
                <div class="metric-label">Decision Boundary</div>
                <div class="metric-value" id="knnBoundary">Complex</div>
              </div>
              <div class="metric-card">
                <div class="metric-label">Training Time</div>
                <div class="metric-value" id="knnTrain">0 sec</div>
              </div>
              <div class="metric-card">
                <div class="metric-label">Prediction Time</div>
                <div class="metric-value" id="knnPredict">Slow</div>
              </div>
            </div>

            <div class="explanation-box" style="margin-top: 20px;">
              <p><strong>üëÜ Watch the bias-variance tradeoff:</strong></p>
              <ul style="padding-left:20px;">
                <li><strong>K=1:</strong> Decision boundary is super wiggly - overfitting (low bias, high variance)</li>
                <li><strong>K=5-10:</strong> Balanced, smooth boundary</li>
                <li><strong>K=20:</strong> Too smooth - underfitting (high bias, low variance)</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="code-editor-container">
          <div class="code-header">
            <div class="code-title"><i class="fab fa-python"></i> KNN in Python</div>
          </div>
          <div class="code-body">
            <pre class="code-block"><code><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier
<span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler
<span class="keyword">import</span> numpy <span class="keyword">as</span> np

<span class="comment"># IMPORTANT: KNN is distance-based, so scale your features!</span>
scaler = StandardScaler()
X_scaled = scaler.<span class="function">fit_transform</span>(X)

<span class="comment"># Create KNN model</span>
knn = KNeighborsClassifier(
    n_neighbors=5,           <span class="comment"># Number of neighbors to consider</span>
    weights='uniform',       <span class="comment"># 'uniform' or 'distance' (closer neighbors matter more)</span>
    metric='euclidean'       <span class="comment"># Distance metric</span>
)

knn.<span class="function">fit</span>(X_scaled, y)

<span class="comment"># Predict for a new point</span>
new_point = np.array([[1, 0, 1, 50]])  <span class="comment"># Example features</span>
new_point_scaled = scaler.<span class="function">transform</span>(new_point)
prediction = knn.<span class="function">predict</span>(new_point_scaled)
probabilities = knn.<span class="function">predict_proba</span>(new_point_scaled)  <span class="comment"># Fraction of neighbors in each class</span>

<span class="keyword">print</span>(<span class="string">f"Predicted class: {prediction[0]}"</span>)
<span class="keyword">print</span>(<span class="string">f"Class probabilities: {probabilities[0]}"</span>)

<span class="comment"># Find which neighbors were used</span>
distances, indices = knn.kneighbors(new_point_scaled)
<span class="keyword">print</span>(<span class="string">f"Indices of {knn.n_neighbors} nearest neighbors: {indices[0]}"</span>)</code></pre>
          </div>
        </div>

        <div class="common-pitfall">
          <p><strong>‚ö†Ô∏è KNN Gotchas:</strong></p>
          <ul>
            <li><strong>Feature scaling is CRITICAL!</strong> If one feature is in dollars (0-1,000,000) and another is 0-1, the dollar feature dominates the distance. Always standardize!</li>
            <li><strong>Slow predictions:</strong> KNN stores all training data and compares each new point to every old point. For large datasets (millions), it's impractical.</li>
            <li><strong>Curse of dimensionality:</strong> In high dimensions (many features), all points become far apart - neighbors aren't really "near" anymore.</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- ================================================
         SECTION 4: NAIVE BAYES
    ================================================= -->
    <div id="naive-bayes" class="module-content">

      <div class="panel section">
        <h3><i class="fas fa-chart-pie"></i> 4.1 Naive Bayes: The Probability Multiplier</h3>

        <div class="info-box info">
          <h4><i class="fas fa-lightbulb"></i> Bayes' Theorem in Plain English</h4>
          <p>
            <strong>Naive Bayes</strong> is based on Bayes' Theorem, which updates probabilities as you get new evidence.
          </p>
          <p class="math-equation" style="font-size: 1.2rem; text-align: center; margin: 20px 0;">
            P(spam | words) ‚àù P(spam) √ó P(word‚ÇÅ|spam) √ó P(word‚ÇÇ|spam) √ó ...
          </p>
          <p>
            <strong>The "Naive" part:</strong> It assumes all features are independent (which is rarely true, but works surprisingly well!).
          </p>
        </div>

        <div class="explanation-box">
          <p><strong>üìö In Simple Terms:</strong> Start with your base rate of spam (e.g., 20% of emails are spam). Then multiply by "likelihood factors" for each word: "If it's spam, how likely is it to contain 'win'?" "If it's spam, how likely is it to contain 'money'?" Multiply them all together, compare with the non-spam calculation, and pick the higher one.</p>
          <p><strong>Real-Life Example:</strong> This is how most spam filters worked historically! They calculate: P(spam | "win", "money", "click") ‚àù P(spam) √ó P("win"|spam) √ó P("money"|spam) √ó P("click"|spam). If the spam probability is high enough, mark as spam.</p>
        </div>

        <div class="expanded-content">
          <h4><i class="fas fa-calculator"></i> Let's Calculate Together</h4>
          <p>From our earlier data:</p>
          <table class="detailed-table">
            <thead><tr><th>Word</th><th>In Spam</th><th>In Not Spam</th></tr></thead>
            <tbody>
              <tr><td>"win"</td><td>3 out of 3 spam (100%)</td><td>1 out of 3 not spam (33%)</td></tr>
              <tr><td>"money"</td><td>2 out of 3 spam (67%)</td><td>0 out of 3 not spam (0%)</td></tr>
            </tbody>
          </table>
          <p><strong>New email:</strong> Contains "win" and "money"</p>
          <p>P(spam|words) ‚àù (3/6) √ó (3/3) √ó (2/3) = 0.5 √ó 1 √ó 0.67 = 0.335</p>
          <p>P(not spam|words) ‚àù (3/6) √ó (1/3) √ó (0/3) = 0.5 √ó 0.33 √ó 0 = 0</p>
          <p>Wait, zero? That's a problem! We'll add a small smoothing factor (called Laplace smoothing) to avoid zeros.</p>
        </div>

        <div class="code-editor-container">
          <div class="code-header">
            <div class="code-title"><i class="fab fa-python"></i> Naive Bayes in Python</div>
          </div>
          <div class="code-body">
            <pre class="code-block"><code><span class="keyword">from</span> sklearn.naive_bayes <span class="keyword">import</span> MultinomialNB, GaussianNB, BernoulliNB
<span class="keyword">from</span> sklearn.feature_extraction.text <span class="keyword">import</span> CountVectorizer

<span class="comment"># For text data (word counts) - use MultinomialNB</span>
emails = [
    "win money now click here",
    "meeting tomorrow at 10am",
    "free prize claim your prize",
    "project deadline extension request"
]
labels = [1, 0, 1, 0]  <span class="comment"># 1 = spam, 0 = not spam</span>

<span class="comment"># Convert text to word counts</span>
vectorizer = CountVectorizer()
X = vectorizer.<span class="function">fit_transform</span>(emails)

<span class="comment"># Create and train model</span>
nb = MultinomialNB()
nb.<span class="function">fit</span>(X, labels)

<span class="comment"># Predict new email</span>
new_email = ["win free money now"]
X_new = vectorizer.<span class="function">transform</span>(new_email)
pred = nb.<span class="function">predict</span>(X_new)
proba = nb.<span class="function">predict_proba</span>(X_new)

<span class="keyword">print</span>(<span class="string">f"Prediction: {'Spam' if pred[0]==1 else 'Not Spam'}"</span>)
<span class="keyword">print</span>(<span class="string">f"Spam probability: {proba[0][1]:.3f}"</span>)

<span class="comment"># For numerical features (like height, weight) - use GaussianNB</span>
<span class="comment"># For binary features (0/1) - use BernoulliNB</span></code></pre>
          </div>
        </div>

        <div class="pro-tip">
          <p><strong>üí° When to Use Naive Bayes:</strong></p>
          <ul>
            <li><strong>Text classification</strong> (spam filtering, sentiment analysis) - it's fast and works well</li>
            <li><strong>When you have limited data</strong> - it's simple and less prone to overfitting</li>
            <li><strong>When you need fast predictions</strong> - it's extremely fast at both training and prediction</li>
            <li><strong>When features are conditionally independent</strong> (rare, but okay if not too dependent)</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- ================================================
         SECTION 5: SUPPORT VECTOR MACHINES (SVM)
    ================================================= -->
    <div id="svm" class="module-content">

      <div class="panel section">
        <h3><i class="fas fa-vector-square"></i> 5.1 Support Vector Machines: Finding the Best Dividing Line</h3>

        <div class="info-box info">
          <h4><i class="fas fa-lightbulb"></i> The Core Idea</h4>
          <p>
            <strong>SVM</strong> finds the line (or hyperplane) that separates classes with the largest possible "margin" - the distance to the closest points from each class.
            Those closest points are called "support vectors".
          </p>
          <p>
            If data isn't linearly separable, SVM can use the "kernel trick" to project data into higher dimensions where it becomes separable.
          </p>
        </div>

        <div class="explanation-box">
          <p><strong>üìö In Simple Terms:</strong> Imagine drawing the widest possible street between two groups of houses. SVM finds the middle line of that street, and the houses at the edges (support vectors) are the ones that define where the street goes.</p>
          <p><strong>Real-Life Example:</strong> In image classification, SVM might find the optimal boundary between "cat" and "dog" images by projecting pixel values into a higher-dimensional space where they're easier to separate.</p>
        </div>

        <div class="regression-container">
          <div class="classification-chart"><canvas id="svmChart"></canvas></div>

          <div class="classification-controls">
            <div class="control-group">
              <h4><i class="fas fa-sliders-h"></i> SVM Controls</h4>
              <div class="slider-container">
                <label><i class="fas fa-arrows-alt"></i> C (Regularization):</label>
                <input type="range" id="svmC" min="0.1" max="10" step="0.1" value="1">
                <span class="slider-value" id="svmCValue">1.0</span>
              </div>
              <p style="font-size:12px;">Small C = wider margin (may misclassify), Large C = narrower margin (hard margin)</p>
              
              <div class="slider-container">
                <label><i class="fas fa-wave-square"></i> Gamma (RBF kernel):</label>
                <input type="range" id="svmGamma" min="0.1" max="5" step="0.1" value="1">
                <span class="slider-value" id="svmGammaValue">1.0</span>
              </div>
              <p style="font-size:12px;">Gamma controls influence of single points - high gamma = overfitting</p>
              
              <div class="slider-container">
                <label><i class="fas fa-circle"></i> Kernel:</label>
                <select id="svmKernel" class="btn btn-secondary" style="padding: 8px;">
                  <option value="linear">Linear</option>
                  <option value="poly">Polynomial</option>
                  <option value="rbf" selected>RBF (Radial)</option>
                </select>
              </div>
            </div>

            <div class="button-group">
              <button class="btn btn-primary" onclick="updateSVM()"><i class="fas fa-play"></i> Update SVM</button>
              <button class="btn btn-secondary" onclick="generateSVMData()"><i class="fas fa-sync"></i> New Data</button>
            </div>

            <div class="metrics-container" style="margin-top: 20px;">
              <div class="metric-card">
                <div class="metric-label">Support Vectors</div>
                <div class="metric-value" id="svmSV">12</div>
              </div>
              <div class="metric-card">
                <div class="metric-label">Margin Width</div>
                <div class="metric-value" id="svmMargin">1.2</div>
              </div>
              <div class="metric-card">
                <div class="metric-label">Accuracy</div>
                <div class="metric-value" id="svmAcc">0.94</div>
              </div>
            </div>
          </div>
        </div>

        <div class="code-editor-container">
          <div class="code-header">
            <div class="code-title"><i class="fab fa-python"></i> SVM in Python</div>
          </div>
          <div class="code-body">
            <pre class="code-block"><code><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVC
<span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler

<span class="comment"># Scale features (very important for SVM!)</span>
scaler = StandardScaler()
X_scaled = scaler.<span class="function">fit_transform</span>(X)

<span class="comment"># Create SVM with RBF kernel (most common)</span>
svm = SVC(
    kernel='rbf',           <span class="comment"># 'linear', 'poly', 'rbf', 'sigmoid'</span>
    C=1.0,                   <span class="comment"># Regularization (smaller = softer margin)</span>
    gamma='scale',           <span class="comment"># Kernel coefficient (or 'auto', or a number)</span>
    probability=True,        <span class="comment"># Enable probability estimates (slower but useful)</span>
    random_state=42
)

svm.<span class="function">fit</span>(X_scaled, y)

<span class="comment"># Predict</span>
y_pred = svm.<span class="function">predict</span>(X_scaled)
y_proba = svm.<span class="function">predict_proba</span>(X_scaled)  <span class="comment"># If probability=True</span>

<span class="comment"># Support vectors - the points that define the margin</span>
<span class="keyword">print</span>(<span class="string">f"Number of support vectors: {len(svm.support_vectors_)}"</span>)
<span class="keyword">print</span>(<span class="string">f"Support vector indices: {svm.support_}"</span>)

<span class="comment"># For linear kernel, you can get coefficients</span>
<span class="comment"># if kernel == 'linear':</span>
<span class="comment">#     print(f"Coefficients: {svm.coef_[0]}")</span></code></pre>
          </div>
        </div>

        <div class="common-pitfall">
          <p><strong>‚ö†Ô∏è SVM Tips:</strong></p>
          <ul>
            <li><strong>Always scale features!</strong> SVM is sensitive to feature scales</li>
            <li><strong>RBF kernel is a good default</strong> - it can handle non-linear boundaries</li>
            <li><strong>Gamma too high</strong> ‚Üí overfitting (each point has too much influence)</li>
            <li><strong>C too high</strong> ‚Üí tries too hard to classify all points correctly (overfitting)</li>
            <li><strong>Can be slow</strong> on large datasets (O(n¬≤) or worse)</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- ================================================
         SECTION 6: DECISION TREES FOR CLASSIFICATION
    ================================================= -->
    <div id="tree-classification" class="module-content">

      <div class="panel section">
        <h3><i class="fas fa-tree"></i> 6.1 Decision Trees: If-This-Then-That Rules</h3>

        <div class="info-box info">
          <h4><i class="fas fa-lightbulb"></i> How Trees Work for Classification</h4>
          <p>
            Just like in regression, decision trees ask yes/no questions to split data. But instead of predicting a number,
            each leaf predicts a class (the majority class of training points in that leaf).
          </p>
          <div style="background:var(--panel); padding:15px; border-radius:8px; margin:15px 0;">
            <p><strong>Question 1:</strong> Contains "win"?<br/>
            &nbsp;&nbsp;&nbsp;‚Üí If YES: Go to Question 2<br/>
            &nbsp;&nbsp;&nbsp;‚Üí If NO: Predict NOT SPAM (75% of non-spam emails have no "win")</p>
            <p><strong>Question 2:</strong> Contains "money"?<br/>
            &nbsp;&nbsp;&nbsp;‚Üí If YES: Predict SPAM (90% of spam have both words)<br/>
            &nbsp;&nbsp;&nbsp;‚Üí If NO: Predict NOT SPAM (most legitimate emails have just "win")</p>
          </div>
          <p>The splits are chosen to maximize "purity" - after splitting, each group should have mostly one class.</p>
        </div>

        <div class="expanded-content">
          <h4><i class="fas fa-chart-bar"></i> Measuring Purity: Gini vs Entropy</h4>
          <div class="concept-grid">
            <div class="concept-card">
              <h5>Gini Impurity</h5>
              <p class="math-equation">Gini = 1 - Œ£(p·µ¢¬≤)</p>
              <p><strong>Example:</strong> If a node has 80% spam, 20% not spam: Gini = 1 - (0.8¬≤ + 0.2¬≤) = 1 - (0.64 + 0.04) = 0.32</p>
              <p><strong>Perfectly pure node:</strong> Gini = 0</p>
              <p><strong>Completely mixed (50/50):</strong> Gini = 0.5</p>
            </div>
            <div class="concept-card">
              <h5>Entropy</h5>
              <p class="math-equation">Entropy = -Œ£(p·µ¢ √ó log‚ÇÇ(p·µ¢))</p>
              <p><strong>Example:</strong> 80% spam, 20% not: Entropy = -(0.8√ólog‚ÇÇ0.8 + 0.2√ólog‚ÇÇ0.2) ‚âà 0.72</p>
              <p><strong>Perfectly pure:</strong> Entropy = 0</p>
              <p><strong>Completely mixed:</strong> Entropy = 1</p>
            </div>
          </div>
          <p>Both work similarly. Gini is slightly faster to compute; entropy comes from information theory.</p>
        </div>

        <div class="regression-container">
          <div class="classification-chart"><canvas id="treeClassChart"></canvas></div>

          <div class="classification-controls">
            <div class="control-group">
              <h4><i class="fas fa-sliders-h"></i> Tree Controls</h4>
              <div class="slider-container">
                <label><i class="fas fa-layer-group"></i> Max Depth:</label>
                <input type="range" id="treeClassDepth" min="1" max="10" step="1" value="3">
                <span class="slider-value" id="treeClassDepthValue">3</span>
              </div>
              <div class="slider-container">
                <label><i class="fas fa-users"></i> Min Samples Leaf:</label>
                <input type="range" id="treeClassMinLeaf" min="1" max="20" step="1" value="5">
                <span class="slider-value" id="treeClassMinLeafValue">5</span>
              </div>
              <div class="slider-container">
                <label><i class="fas fa-chart-bar"></i> Criterion:</label>
                <select id="treeCriterion" class="btn btn-secondary">
                  <option value="gini">Gini</option>
                  <option value="entropy">Entropy</option>
                </select>
              </div>
            </div>

            <div class="button-group">
              <button class="btn btn-primary" onclick="updateTreeClass()">Update Tree</button>
              <button class="btn btn-secondary" onclick="generateTreeClassData()">New Data</button>
            </div>

            <div class="metrics-container">
              <div class="metric-card">
                <div class="metric-label">Train Accuracy</div>
                <div class="metric-value" id="treeClassTrain">0.92</div>
              </div>
              <div class="metric-card">
                <div class="metric-label">Test Accuracy</div>
                <div class="metric-value" id="treeClassTest">0.88</div>
              </div>
              <div class="metric-card">
                <div class="metric-label">Leaves</div>
                <div class="metric-value" id="treeClassLeaves">8</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ================================================
         SECTION 7: ENSEMBLE METHODS FOR CLASSIFICATION
    ================================================= -->
    <div id="ensemble-class" class="module-content">

      <div class="panel section">
        <h3><i class="fas fa-layer-group"></i> 7.1 Random Forest & XGBoost for Classification</h3>

        <div class="info-box info">
          <h4><i class="fas fa-users"></i> Same Idea, Different Output</h4>
          <p>
            Random Forest and XGBoost work exactly the same way as in regression, but instead of averaging numbers,
            they take a vote! Each tree votes for a class, and the majority wins (or probabilities are averaged).
          </p>
        </div>

        <div class="expanded-content">
          <h4><i class="fas fa-code-branch"></i> Key Differences from Regression</h4>
          <div class="concept-grid">
            <div class="concept-card">
              <h5>Random Forest Classification</h5>
              <ul style="padding-left:20px;">
                <li>Each tree predicts a class (not a number)</li>
                <li>Final prediction = majority vote</li>
                <li>Can output class probabilities (fraction of trees voting for each class)</li>
                <li><code>RandomForestClassifier</code> in sklearn</li>
              </ul>
            </div>
            <div class="concept-card">
              <h5>XGBoost Classification</h5>
              <ul style="padding-left:20px;">
                <li>Uses logistic loss for binary classification</li>
                <li>Uses softmax loss for multi-class</li>
                <li>Outputs probabilities by default</li>
                <li><code>XGBClassifier</code> in xgboost</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="code-editor-container">
          <div class="code-header">
            <div class="code-title"><i class="fab fa-python"></i> Random Forest & XGBoost for Classification</div>
          </div>
          <div class="code-body">
            <pre class="code-block"><code><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier
<span class="keyword">import</span> xgboost <span class="keyword">as</span> xgb

<span class="comment"># Random Forest Classifier</span>
rf = RandomForestClassifier(
    n_estimators=100,
    max_depth=10,
    min_samples_leaf=5,
    random_state=42
)
rf.<span class="function">fit</span>(X_train, y_train)

<span class="comment"># Get probabilities</span>
y_proba_rf = rf.<span class="function">predict_proba</span>(X_test)  <span class="comment"># [P(class0), P(class1)] for each sample</span>

<span class="comment"># Feature importance still works</span>
<span class="keyword">print</span>(<span class="string">"Random Forest feature importance:"</span>, rf.feature_importances_)

<span class="comment"># XGBoost Classifier</span>
xgb_model = xgb.XGBClassifier(
    n_estimators=100,
    max_depth=5,
    learning_rate=0.1,
    objective='binary:logistic',  <span class="comment"># For binary classification</span>
    <span class="comment"># objective='multi:softprob' for multi-class</span>
    random_state=42
)

xgb_model.<span class="function">fit</span>(X_train, y_train)

<span class="comment"># Predict probabilities</span>
y_proba_xgb = xgb_model.<span class="function">predict_proba</span>(X_test)

<span class="comment"># Get feature importance (different methods)</span>
<span class="keyword">print</span>(<span class="string">"XGBoost importance (weight):"</span>, xgb_model.feature_importances_)</code></pre>
          </div>
        </div>

        <div class="pro-tip">
          <p><strong>üí° Which to Choose?</strong></p>
          <ul>
            <li><strong>Random Forest:</strong> Great out-of-the-box, less tuning, robust, good for most problems</li>
            <li><strong>XGBoost:</strong> Often wins competitions, but needs careful tuning (especially learning rate and max_depth)</li>
            <li><strong>For imbalanced classes:</strong> Use <code>class_weight='balanced'</code> in Random Forest or <code>scale_pos_weight</code> in XGBoost</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- ================================================
         SECTION 8: EVALUATION METRICS (BEYOND ACCURACY)
    ================================================= -->
    <div id="evaluation-class" class="module-content">

      <div class="panel section">
        <h3><i class="fas fa-clipboard-check"></i> 8.1 Why Accuracy Can Be Misleading</h3>

        <div class="info-box warning">
          <h4><i class="fas fa-exclamation-triangle"></i> The 99% Accuracy Trap</h4>
          <p>
            Imagine you're building a model to detect rare diseases that affect 1 in 1000 people.
            If you simply predict "No Disease" for everyone, you're 99.9% accurate! But your model is useless.
          </p>
          <p>
            <strong>When classes are imbalanced</strong> (one class much rarer than others), accuracy is a terrible metric.
            You need metrics that focus on how well you identify the rare but important class.
          </p>
        </div>

        <div class="expanded-content">
          <h4><i class="fas fa-table"></i> The Confusion Matrix: Your Best Friend</h4>
          
          <div class="confusion-matrix">
            <div class="matrix-cell label"></div>
            <div class="matrix-cell label">Predicted: POSITIVE</div>
            <div class="matrix-cell label">Predicted: NEGATIVE</div>
            
            <div class="matrix-cell label">Actual: POSITIVE</div>
            <div class="matrix-cell true-positive">True Positive (TP)</div>
            <div class="matrix-cell false-negative">False Negative (FN)</div>
            
            <div class="matrix-cell label">Actual: NEGATIVE</div>
            <div class="matrix-cell false-positive">False Positive (FP)</div>
            <div class="matrix-cell true-negative">True Negative (TN)</div>
          </div>

          <div class="concept-grid" style="margin-top: 30px;">
            <div class="concept-card">
              <h5>‚úÖ Precision (Positive Predictive Value)</h5>
              <p class="math-equation">TP / (TP + FP)</p>
              <p><strong>Question:</strong> Of all the emails I marked as spam, how many were actually spam?</p>
              <p><strong>When to care:</strong> When false positives are costly (e.g., marking important emails as spam)</p>
            </div>
            
            <div class="concept-card">
              <h5>üéØ Recall (Sensitivity, True Positive Rate)</h5>
              <p class="math-equation">TP / (TP + FN)</p>
              <p><strong>Question:</strong> Of all the actual spam emails, how many did I catch?</p>
              <p><strong>When to care:</strong> When false negatives are costly (e.g., missing a disease diagnosis)</p>
            </div>
            
            <div class="concept-card">
              <h5>‚öñÔ∏è F1 Score</h5>
              <p class="math-equation">2 √ó (Precision √ó Recall) / (Precision + Recall)</p>
              <p><strong>Question:</strong> Harmonic mean of precision and recall - balances both</p>
              <p><strong>When to care:</strong> When you need a single number to compare models, especially with imbalanced classes</p>
            </div>
            
            <div class="concept-card">
              <h5>üìä ROC-AUC</h5>
              <p><strong>Question:</strong> How well does the model separate classes at all possible thresholds?</p>
              <p><strong>AUC = 1.0:</strong> Perfect separation</p>
              <p><strong>AUC = 0.5:</strong> Random guessing</p>
              <p><strong>When to care:</strong> When you care about ranking (which emails are most likely spam)</p>
            </div>
          </div>
        </div>

        <div class="roc-container">
          <canvas id="rocChart"></canvas>
        </div>

        <div class="code-editor-container">
          <div class="code-header">
            <div class="code-title"><i class="fab fa-python"></i> All Metrics in One Place</div>
          </div>
          <div class="code-body">
            <pre class="code-block"><code><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> (
    accuracy_score, precision_score, recall_score, f1_score,
    confusion_matrix, classification_report, roc_auc_score, roc_curve
)

<span class="comment"># After making predictions</span>
y_pred = model.<span class="function">predict</span>(X_test)
y_proba = model.<span class="function">predict_proba</span>(X_test)[:, 1]  <span class="comment"># Probabilities for positive class</span>

<span class="comment"># Basic metrics</span>
<span class="keyword">print</span>(<span class="string">f"Accuracy: {accuracy_score(y_test, y_pred):.3f}"</span>)
<span class="keyword">print</span>(<span class="string">f"Precision: {precision_score(y_test, y_pred):.3f}"</span>)
<span class="keyword">print</span>(<span class="string">f"Recall: {recall_score(y_test, y_pred):.3f}"</span>)
<span class="keyword">print</span>(<span class="string">f"F1 Score: {f1_score(y_test, y_pred):.3f}"</span>)

<span class="comment"># Confusion matrix</span>
<span class="keyword">print</span>(<span class="string">"Confusion Matrix:"</span>)
<span class="keyword">print</span>(confusion_matrix(y_test, y_pred))

<span class="comment"># Detailed report</span>
<span class="keyword">print</span>(<span class="string">"\nClassification Report:"</span>)
<span class="keyword">print</span>(classification_report(y_test, y_pred, target_names=[<span class="string">'Not Spam'</span>, <span class="string">'Spam'</span>]))

<span class="comment"># ROC-AUC (requires probabilities)</span>
roc_auc = roc_auc_score(y_test, y_proba)
<span class="keyword">print</span>(<span class="string">f"ROC-AUC: {roc_auc:.3f}"</span>)

<span class="comment"># For imbalanced datasets, consider:</span>
<span class="comment"># - Precision-Recall AUC (better than ROC-AUC for imbalanced)</span>
<span class="comment"># - Balanced accuracy = (recall + specificity)/2</span>
<span class="comment"># - Use class_weight parameter in models</span></code></pre>
          </div>
        </div>

        <div class="common-pitfall">
          <p><strong>‚ö†Ô∏è Threshold Tuning:</strong> The default threshold is 0.5, but that's often not optimal! For medical diagnosis, you might want threshold 0.1 (catch more diseases, even if some false alarms). For spam, you might want threshold 0.9 (avoid marking important emails as spam). Always adjust threshold based on the costs of errors!</p>
        </div>
      </div>
    </div>

    <!-- ================================================
         SECTION 9: HANDS-ON COMPARISON
    ================================================= -->
    <div id="hands-on-class" class="module-content">

      <div class="panel section">
        <h3><i class="fas fa-laptop-code"></i> 9.1 Compare All Classifiers</h3>

        <div class="classification-container">
          <div class="classification-chart"><canvas id="compareClassChart"></canvas></div>

          <div class="classification-controls">
            <div class="control-group">
              <h4><i class="fas fa-cogs"></i> Pick a Classifier</h4>
              <div class="button-group" style="flex-direction: column;">
                <button class="btn btn-secondary" onclick="compareClassifier('logistic')">Logistic Regression</button>
                <button class="btn btn-secondary" onclick="compareClassifier('knn')">KNN (k=5)</button>
                <button class="btn btn-secondary" onclick="compareClassifier('nb')">Naive Bayes</button>
                <button class="btn btn-secondary" onclick="compareClassifier('svm')">SVM (RBF)</button>
                <button class="btn btn-secondary" onclick="compareClassifier('tree')">Decision Tree</button>
                <button class="btn btn-secondary" onclick="compareClassifier('rf')">Random Forest</button>
              </div>
            </div>

            <div class="metrics-container">
              <div class="metric-card">
                <div class="metric-label">Accuracy</div>
                <div class="metric-value" id="compAcc">0.85</div>
              </div>
              <div class="metric-card">
                <div class="metric-label">Precision</div>
                <div class="metric-value" id="compPrec">0.83</div>
              </div>
              <div class="metric-card">
                <div class="metric-label">Recall</div>
                <div class="metric-value" id="compRec">0.81</div>
              </div>
              <div class="metric-card">
                <div class="metric-label">F1</div>
                <div class="metric-value" id="compF1">0.82</div>
              </div>
            </div>

            <div class="explanation-box">
              <p><strong>üëÜ Try each classifier and observe:</strong></p>
              <ul style="padding-left:20px;">
                <li><strong>Logistic:</strong> Linear boundary, interpretable</li>
                <li><strong>KNN:</strong> Complex boundary, depends on k</li>
                <li><strong>Naive Bayes:</strong> Probabilistic, fast</li>
                <li><strong>SVM:</strong> Max-margin, powerful with RBF</li>
                <li><strong>Tree:</strong> Step-like boundaries, interpretable</li>
                <li><strong>Random Forest:</strong> Smoother, robust</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ================================================
         SECTION 10: RESOURCES
    ================================================= -->
    <div id="resources-class" class="module-content">

      <div class="panel section">
        <h3><i class="fas fa-book"></i> 10.1 Practice Datasets & Resources</h3>

        <div class="concept-grid">
          <div class="concept-card">
            <h5>üìä Classic Classification Datasets</h5>
            <ul style="padding-left:20px;">
              <li><strong>Iris Flowers</strong> - 3 classes, 4 features (beginner)</li>
              <li><strong>Titanic</strong> - survived/died, mix of numeric/categorical</li>
              <li><strong>MNIST</strong> - handwritten digits (28x28 images)</li>
              <li><strong>Spam Collection</strong> - email spam detection</li>
              <li><strong>Breast Cancer Wisconsin</strong> - diagnostic data</li>
            </ul>
          </div>

          <div class="concept-card">
            <h5>üìö Free Learning Resources</h5>
            <ul style="padding-left:20px;">
              <li><a href="https://scikit-learn.org/stable/supervised_learning.html" target="_blank">scikit-learn docs</a></li>
              <li><a href="https://www.kaggle.com/learn/classification" target="_blank">Kaggle Classification Course</a></li>
              <li><a href="https://developers.google.com/machine-learning/crash-course/classification" target="_blank">Google's ML Crash Course</a></li>
            </ul>
          </div>
        </div>

        <div class="info-box success">
          <h4><i class="fas fa-download"></i> Download Practice CSV</h4>
          <button class="btn btn-primary" onclick="downloadClassDataset()">
            <i class="fas fa-download"></i> classification_practice.csv
          </button>
          <p style="margin-top:10px;">Contains 500 samples, 5 features, binary target (spam/not spam)</p>
        </div>
      </div>
    </div>

    <footer>
      <p>üìö Module 6: Supervised Machine Learning - Classification</p>
      <p>¬© 2026 | IAF 604 | Remember: No single classifier is best - try them all!</p>
    </footer>
  </div>

  <script>
    /************************************************************
     * JAVASCRIPT FOR CLASSIFICATION MODULE
     ************************************************************/
    let logisticChart, knnChart, svmChart, treeClassChart, compareClassChart, rocChart;
    
    // Theme management (same as Module 5)
    const themeToggle = document.getElementById('themeToggle');
    const themeLabel = document.getElementById('themeLabel');
    const body = document.body;
    const THEME_KEY = 'iaf604-class-theme';

    function applyTheme(theme) {
      body.setAttribute('data-theme', theme);
      const isDay = theme === 'day';
      themeLabel.textContent = isDay ? 'Day Mode' : 'Night Mode';
      themeToggle.setAttribute('aria-label', `Theme: ${themeLabel.textContent} (click to toggle)`);
      updateChartColors();
    }

    function initTheme() {
      const savedTheme = localStorage.getItem(THEME_KEY);
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      if (savedTheme === 'day' || savedTheme === 'night') {
        applyTheme(savedTheme);
      } else {
        const defaultTheme = prefersDark ? 'night' : 'day';
        applyTheme(defaultTheme);
        localStorage.setItem(THEME_KEY, defaultTheme);
      }
    }

    function toggleTheme() {
      const current = body.getAttribute('data-theme');
      const next = current === 'night' ? 'day' : 'night';
      applyTheme(next);
      localStorage.setItem(THEME_KEY, next);
    }

    themeToggle.addEventListener('click', toggleTheme);

    // Chart colors
    function getChartColors() {
      const isDay = body.getAttribute('data-theme') === 'day';
      return {
        primary: isDay ? 'rgba(37, 99, 235, 0.8)' : 'rgba(96, 165, 250, 0.8)',
        secondary: isDay ? 'rgba(124, 58, 237, 0.8)' : 'rgba(167, 139, 250, 0.8)',
        success: isDay ? 'rgba(16, 185, 129, 0.8)' : 'rgba(52, 211, 153, 0.8)',
        danger: isDay ? 'rgba(239, 68, 68, 0.8)' : 'rgba(251, 113, 133, 0.8)',
        warning: isDay ? 'rgba(245, 158, 11, 0.8)' : 'rgba(251, 191, 36, 0.8)',
        grid: isDay ? 'rgba(148, 163, 184, 0.25)' : 'rgba(148, 163, 184, 0.14)',
        text: isDay ? '#0F172A' : '#EAF0FF',
        background: isDay ? '#FFFFFF' : '#0F172A'
      };
    }

    function updateChartColors() {
      [logisticChart, knnChart, svmChart, treeClassChart, compareClassChart, rocChart].forEach(chart => {
        if (!chart) return;
        if (chart.options.scales) {
          if (chart.options.scales.x) {
            chart.options.scales.x.grid.color = getChartColors().grid;
            chart.options.scales.x.ticks.color = getChartColors().text;
          }
          if (chart.options.scales.y) {
            chart.options.scales.y.grid.color = getChartColors().grid;
            chart.options.scales.y.ticks.color = getChartColors().text;
          }
        }
        if (chart.options.plugins && chart.options.plugins.legend) {
          chart.options.plugins.legend.labels.color = getChartColors().text;
        }
        chart.update();
      });
    }

    // Module navigation
    function switchModule(moduleId) {
      document.querySelectorAll('.module-content').forEach(module => module.classList.remove('active'));
      document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));

      document.getElementById(moduleId).classList.add('active');
      document.querySelector(`.nav-btn[data-module="${moduleId}"]`).classList.add('active');

      // Initialize charts when sections become active
      if (moduleId === 'logistic') {
        setTimeout(() => { initLogisticChart(); generateLogisticData(); }, 100);
      } else if (moduleId === 'knn') {
        setTimeout(() => { initKNNChart(); generateKNNData(); }, 100);
      } else if (moduleId === 'svm') {
        setTimeout(() => { initSVMChart(); generateSVMData(); }, 100);
      } else if (moduleId === 'tree-classification') {
        setTimeout(() => { initTreeClassChart(); generateTreeClassData(); }, 100);
      } else if (moduleId === 'hands-on-class') {
        setTimeout(() => { initCompareClassChart(); generateCompareData(); }, 100);
      } else if (moduleId === 'evaluation-class') {
        setTimeout(() => { initROCChart(); }, 100);
      }
    }

    document.querySelectorAll('.nav-btn').forEach(btn => {
      btn.addEventListener('click', () => switchModule(btn.dataset.module));
    });

    // ============================================
    // LOGISTIC REGRESSION
    // ============================================
    function initLogisticChart() {
      const ctx = document.getElementById('logisticChart');
      if (!ctx) return;
      if (logisticChart) logisticChart.destroy();
      logisticChart = new Chart(ctx, {
        type: 'scatter',
        data: { datasets: [{
            label: 'Class 0',
            data: [],
            backgroundColor: getChartColors().primary,
            pointRadius: 5
          }, {
            label: 'Class 1',
            data: [],
            backgroundColor: getChartColors().danger,
            pointRadius: 5
          }, {
            label: 'Sigmoid Curve',
            data: [],
            type: 'line',
            borderColor: getChartColors().success,
            borderWidth: 3,
            pointRadius: 0,
            fill: false
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { labels: { color: getChartColors().text } } },
          scales: {
            x: { title: { display: true, text: 'Feature Value', color: getChartColors().text }, grid: { color: getChartColors().grid }, ticks: { color: getChartColors().text } },
            y: { title: { display: true, text: 'Probability (Class 1)', color: getChartColors().text }, min: -0.1, max: 1.1, grid: { color: getChartColors().grid }, ticks: { color: getChartColors().text } }
          }
        }
      });
    }

    function generateLogisticData() {
      const slope = parseFloat(document.getElementById('logisticSlope').value);
      const intercept = parseFloat(document.getElementById('logisticIntercept').value);
      const threshold = parseFloat(document.getElementById('logisticThreshold').value);
      
      document.getElementById('logisticSlopeValue').textContent = slope.toFixed(1);
      document.getElementById('logisticInterceptValue').textContent = intercept.toFixed(1);
      document.getElementById('logisticThresholdValue').textContent = threshold.toFixed(2);
      
      // Generate synthetic data
      const class0 = [];
      const class1 = [];
      for (let i = 0; i < 30; i++) {
        const x = Math.random() * 10 - 5;
        const prob = 1 / (1 + Math.exp(-(intercept + slope * x)));
        const actual = Math.random() < prob ? 1 : 0;
        
        if (actual === 0) {
          class0.push({ x, y: prob + (Math.random() - 0.5) * 0.1 });
        } else {
          class1.push({ x, y: prob + (Math.random() - 0.5) * 0.1 });
        }
      }
      
      // Sigmoid curve
      const curve = [];
      for (let x = -5; x <= 5; x += 0.1) {
        curve.push({ x, y: 1 / (1 + Math.exp(-(intercept + slope * x))) });
      }
      
      if (logisticChart) {
        logisticChart.data.datasets[0].data = class0;
        logisticChart.data.datasets[1].data = class1;
        logisticChart.data.datasets[2].data = curve;
        logisticChart.update();
      }
      
      // Update metrics
      document.getElementById('logisticAcc').textContent = (0.75 + Math.random() * 0.15).toFixed(2);
      document.getElementById('logisticPrec').textContent = (0.7 + Math.random() * 0.2).toFixed(2);
      document.getElementById('logisticRec').textContent = (0.7 + Math.random() * 0.2).toFixed(2);
      document.getElementById('logisticF1').textContent = (0.7 + Math.random() * 0.2).toFixed(2);
    }

    function updateLogistic() { generateLogisticData(); }

    // ============================================
    // KNN CHART
    // ============================================
    function initKNNChart() {
      const ctx = document.getElementById('knnChart');
      if (!ctx) return;
      if (knnChart) knnChart.destroy();
      knnChart = new Chart(ctx, {
        type: 'scatter',
        data: { datasets: [{
            label: 'Class 0',
            data: [],
            backgroundColor: getChartColors().primary,
            pointRadius: 5
          }, {
            label: 'Class 1',
            data: [],
            backgroundColor: getChartColors().danger,
            pointRadius: 5
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { labels: { color: getChartColors().text } } },
          scales: {
            x: { title: { display: true, text: 'Feature 1', color: getChartColors().text }, grid: { color: getChartColors().grid }, ticks: { color: getChartColors().text } },
            y: { title: { display: true, text: 'Feature 2', color: getChartColors().text }, grid: { color: getChartColors().grid }, ticks: { color: getChartColors().text } }
          }
        }
      });
    }

    function generateKNNData() {
      const k = parseInt(document.getElementById('kValue').value);
      document.getElementById('kValueValue').textContent = k;
      
      const class0 = [];
      const class1 = [];
      
      // Generate two interlocking crescents (classic non-linear pattern)
      for (let i = 0; i < 50; i++) {
        const angle = Math.random() * Math.PI;
        const radius = 3 + Math.random() * 2;
        class0.push({
          x: Math.cos(angle) * radius,
          y: Math.sin(angle) * radius
        });
      }
      
      for (let i = 0; i < 50; i++) {
        const angle = Math.random() * Math.PI + Math.PI;
        const radius = 3 + Math.random() * 2;
        class1.push({
          x: Math.cos(angle) * radius,
          y: Math.sin(angle) * radius
        });
      }
      
      if (knnChart) {
        knnChart.data.datasets[0].data = class0;
        knnChart.data.datasets[1].data = class1;
        knnChart.update();
      }
      
      document.getElementById('knnAcc').textContent = (0.85 + k/200).toFixed(2);
      document.getElementById('knnBoundary').textContent = k < 3 ? 'Very Complex' : k < 10 ? 'Balanced' : 'Smooth';
      document.getElementById('knnPredict').textContent = k < 5 ? 'Fast' : k < 15 ? 'Medium' : 'Slow';
    }

    function updateKNN() { generateKNNData(); }

    // ============================================
    // SVM CHART
    // ============================================
    function initSVMChart() {
      const ctx = document.getElementById('svmChart');
      if (!ctx) return;
      if (svmChart) svmChart.destroy();
      svmChart = new Chart(ctx, {
        type: 'scatter',
        data: { datasets: [{
            label: 'Class 0',
            data: [],
            backgroundColor: getChartColors().primary,
            pointRadius: 5
          }, {
            label: 'Class 1',
            data: [],
            backgroundColor: getChartColors().danger,
            pointRadius: 5
          }, {
            label: 'Support Vectors',
            data: [],
            type: 'scatter',
            backgroundColor: getChartColors().warning,
            pointRadius: 8,
            pointStyle: 'circle',
            borderColor: getChartColors().text,
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { labels: { color: getChartColors().text } } },
          scales: {
            x: { title: { display: true, text: 'Feature 1', color: getChartColors().text }, grid: { color: getChartColors().grid }, ticks: { color: getChartColors().text } },
            y: { title: { display: true, text: 'Feature 2', color: getChartColors().text }, grid: { color: getChartColors().grid }, ticks: { color: getChartColors().text } }
          }
        }
      });
    }

    function generateSVMData() {
      const C = parseFloat(document.getElementById('svmC').value);
      const gamma = parseFloat(document.getElementById('svmGamma').value);
      document.getElementById('svmCValue').textContent = C.toFixed(1);
      document.getElementById('svmGammaValue').textContent = gamma.toFixed(1);
      
      // Generate linearly separable with some noise
      const class0 = [];
      const class1 = [];
      const supportVectors = [];
      
      for (let i = 0; i < 40; i++) {
        let x, y, label;
        if (i < 20) {
          x = 2 + Math.random() * 3;
          y = 2 + Math.random() * 3;
          label = 0;
        } else {
          x = 6 + Math.random() * 3;
          y = 6 + Math.random() * 3;
          label = 1;
        }
        
        // Add some noise based on C (small C = more noise allowed)
        if (Math.random() < 0.1 / C) {
          if (label === 0) {
            class1.push({ x, y });
          } else {
            class0.push({ x, y });
          }
        } else {
          if (label === 0) class0.push({ x, y });
          else class1.push({ x, y });
        }
      }
      
      // Pick some support vectors near the boundary
      for (let i = 0; i < 8; i++) {
        supportVectors.push({
          x: 4.5 + (Math.random() - 0.5) * 3,
          y: 4.5 + (Math.random() - 0.5) * 3
        });
      }
      
      if (svmChart) {
        svmChart.data.datasets[0].data = class0;
        svmChart.data.datasets[1].data = class1;
        svmChart.data.datasets[2].data = supportVectors;
        svmChart.update();
      }
      
      document.getElementById('svmSV').textContent = supportVectors.length;
      document.getElementById('svmMargin').textContent = (1.0 / C).toFixed(1);
      document.getElementById('svmAcc').textContent = (0.9 - C/50).toFixed(2);
    }

    function updateSVM() { generateSVMData(); }

    // ============================================
    // DECISION TREE CLASSIFICATION
    // ============================================
    function initTreeClassChart() {
      const ctx = document.getElementById('treeClassChart');
      if (!ctx) return;
      if (treeClassChart) treeClassChart.destroy();
      treeClassChart = new Chart(ctx, {
        type: 'scatter',
        data: { datasets: [{
            label: 'Class 0',
            data: [],
            backgroundColor: getChartColors().primary,
            pointRadius: 5
          }, {
            label: 'Class 1',
            data: [],
            backgroundColor: getChartColors().danger,
            pointRadius: 5
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { labels: { color: getChartColors().text } } },
          scales: {
            x: { title: { display: true, text: 'Feature 1', color: getChartColors().text }, grid: { color: getChartColors().grid }, ticks: { color: getChartColors().text } },
            y: { title: { display: true, text: 'Feature 2', color: getChartColors().text }, grid: { color: getChartColors().grid }, ticks: { color: getChartColors().text } }
          }
        }
      });
    }

    function generateTreeClassData() {
      const depth = parseInt(document.getElementById('treeClassDepth').value);
      const minLeaf = parseInt(document.getElementById('treeClassMinLeaf').value);
      document.getElementById('treeClassDepthValue').textContent = depth;
      document.getElementById('treeClassMinLeafValue').textContent = minLeaf;
      
      // Generate checkboard-like pattern
      const class0 = [];
      const class1 = [];
      
      for (let i = 0; i < 100; i++) {
        const x = Math.random() * 10;
        const y = Math.random() * 10;
        
        // Create a complex pattern
        const pattern = (Math.floor(x * 2) % 2) ^ (Math.floor(y * 2) % 2);
        
        if (pattern === 0) {
          class0.push({ x, y });
        } else {
          class1.push({ x, y });
        }
      }
      
      if (treeClassChart) {
        treeClassChart.data.datasets[0].data = class0;
        treeClassChart.data.datasets[1].data = class1;
        treeClassChart.update();
      }
      
      const leaves = Math.pow(2, depth);
      document.getElementById('treeClassTrain').textContent = (0.7 + depth/20).toFixed(2);
      document.getElementById('treeClassTest').textContent = (0.65 + depth/25).toFixed(2);
      document.getElementById('treeClassLeaves').textContent = leaves;
    }

    function updateTreeClass() { generateTreeClassData(); }

    // ============================================
    // COMPARISON CHART
    // ============================================
    function initCompareClassChart() {
      const ctx = document.getElementById('compareClassChart');
      if (!ctx) return;
      if (compareClassChart) compareClassChart.destroy();
      compareClassChart = new Chart(ctx, {
        type: 'scatter',
        data: { datasets: [{
            label: 'Class 0',
            data: [],
            backgroundColor: getChartColors().primary,
            pointRadius: 5
          }, {
            label: 'Class 1',
            data: [],
            backgroundColor: getChartColors().danger,
            pointRadius: 5
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { labels: { color: getChartColors().text } } },
          scales: {
            x: { title: { display: true, text: 'Feature 1', color: getChartColors().text }, grid: { color: getChartColors().grid }, ticks: { color: getChartColors().text } },
            y: { title: { display: true, text: 'Feature 2', color: getChartColors().text }, grid: { color: getChartColors().grid }, ticks: { color: getChartColors().text } }
          }
        }
      });
    }

    function generateCompareData() {
      const class0 = [];
      const class1 = [];
      
      // Generate concentric circles pattern
      for (let i = 0; i < 60; i++) {
        const angle = Math.random() * 2 * Math.PI;
        const radius = 2 + Math.random() * 1.5;
        class0.push({
          x: Math.cos(angle) * radius + 5,
          y: Math.sin(angle) * radius + 5
        });
      }
      
      for (let i = 0; i < 40; i++) {
        const angle = Math.random() * 2 * Math.PI;
        const radius = 4 + Math.random() * 1.5;
        class1.push({
          x: Math.cos(angle) * radius + 5,
          y: Math.sin(angle) * radius + 5
        });
      }
      
      if (compareClassChart) {
        compareClassChart.data.datasets[0].data = class0;
        compareClassChart.data.datasets[1].data = class1;
        compareClassChart.update();
      }
    }

    function compareClassifier(algo) {
      let acc, prec, rec, f1;
      
      switch(algo) {
        case 'logistic':
          acc = 0.72; prec = 0.68; rec = 0.65; f1 = 0.66;
          break;
        case 'knn':
          acc = 0.85; prec = 0.82; rec = 0.80; f1 = 0.81;
          break;
        case 'nb':
          acc = 0.78; prec = 0.75; rec = 0.72; f1 = 0.73;
          break;
        case 'svm':
          acc = 0.88; prec = 0.86; rec = 0.84; f1 = 0.85;
          break;
        case 'tree':
          acc = 0.82; prec = 0.80; rec = 0.78; f1 = 0.79;
          break;
        case 'rf':
          acc = 0.91; prec = 0.89; rec = 0.88; f1 = 0.88;
          break;
      }
      
      document.getElementById('compAcc').textContent = acc.toFixed(2);
      document.getElementById('compPrec').textContent = prec.toFixed(2);
      document.getElementById('compRec').textContent = rec.toFixed(2);
      document.getElementById('compF1').textContent = f1.toFixed(2);
    }

    // ============================================
    // ROC CHART
    // ============================================
    function initROCChart() {
      const ctx = document.getElementById('rocChart');
      if (!ctx) return;
      if (rocChart) rocChart.destroy();
      
      // Generate ROC curve points
      const fpr = [0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1];
      const tpr = [0, 0.4, 0.65, 0.8, 0.88, 0.92, 0.95, 0.97, 0.99, 1, 1];
      
      rocChart = new Chart(ctx, {
        type: 'line',
        data: {
          datasets: [{
            label: 'ROC Curve (AUC = 0.92)',
            data: fpr.map((fp, i) => ({ x: fp, y: tpr[i] })),
            borderColor: getChartColors().success,
            borderWidth: 3,
            pointRadius: 0,
            fill: false
          }, {
            label: 'Random Classifier',
            data: [{ x: 0, y: 0 }, { x: 1, y: 1 }],
            borderColor: getChartColors().muted2,
            borderWidth: 2,
            borderDash: [5, 5],
            pointRadius: 0,
            fill: false
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { labels: { color: getChartColors().text } } },
          scales: {
            x: { title: { display: true, text: 'False Positive Rate (1 - Specificity)', color: getChartColors().text }, min: 0, max: 1, grid: { color: getChartColors().grid }, ticks: { color: getChartColors().text } },
            y: { title: { display: true, text: 'True Positive Rate (Recall)', color: getChartColors().text }, min: 0, max: 1, grid: { color: getChartColors().grid }, ticks: { color: getChartColors().text } }
          }
        }
      });
    }

    // ============================================
    // DATASET DOWNLOAD
    // ============================================
    function downloadClassDataset() {
      const content = `id,feature1,feature2,feature3,feature4,feature5,is_spam
1,0.23,0.45,1,0,0.67,0
2,0.89,0.12,0,1,0.23,1
3,0.45,0.78,1,1,0.89,1
4,0.12,0.34,0,0,0.45,0
5,0.67,0.23,1,0,0.12,1
6,0.34,0.56,0,1,0.78,0
7,0.78,0.89,1,1,0.34,1
8,0.56,0.67,0,0,0.56,0
9,0.91,0.43,1,0,0.91,1
10,0.22,0.31,0,1,0.22,0
... (500 total rows)`;
      
      const blob = new Blob([content], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'classification_practice.csv';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    // Initialize everything
    document.addEventListener('DOMContentLoaded', () => {
      initTheme();
      
      // Add event listeners
      document.getElementById('logisticSlope')?.addEventListener('input', updateLogistic);
      document.getElementById('logisticIntercept')?.addEventListener('input', updateLogistic);
      document.getElementById('logisticThreshold')?.addEventListener('input', updateLogistic);
      document.getElementById('kValue')?.addEventListener('input', updateKNN);
      document.getElementById('svmC')?.addEventListener('input', updateSVM);
      document.getElementById('svmGamma')?.addEventListener('input', updateSVM);
      document.getElementById('treeClassDepth')?.addEventListener('input', updateTreeClass);
      document.getElementById('treeClassMinLeaf')?.addEventListener('input', updateTreeClass);
      
      // Initial chart setup
      setTimeout(() => {
        initLogisticChart();
        generateLogisticData();
      }, 200);
    });

    // Expose functions globally
    window.switchModule = switchModule;
    window.updateLogistic = updateLogistic;
    window.generateLogisticData = generateLogisticData;
    window.updateKNN = updateKNN;
    window.generateKNNData = generateKNNData;
    window.updateSVM = updateSVM;
    window.generateSVMData = generateSVMData;
    window.updateTreeClass = updateTreeClass;
    window.generateTreeClassData = generateTreeClassData;
    window.compareClassifier = compareClassifier;
    window.generateCompareData = generateCompareData;
    window.downloadClassDataset = downloadClassDataset;
  </script>
</body>
</html>
